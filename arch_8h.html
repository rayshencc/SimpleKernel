<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SimpleKernel: /root/src/arch/arch.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SimpleKernel<span id="projectnumber">&#160;1.17.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('arch_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">arch.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="cpu__io_8h_source.html">cpu_io.h</a>&gt;</code><br />
<code>#include &lt;sys/cdefs.h&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for arch.h:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h__incl.png" border="0" usemap="#a_2root_2src_2arch_2arch_8h" alt=""/></div>
<map name="a_2root_2src_2arch_2arch_8h" id="a_2root_2src_2arch_2arch_8h">
<area shape="rect" title=" " alt="" coords="485,5,636,31"/>
<area shape="rect" href="cpu__io_8h.html" title=" " alt="" coords="377,79,453,104"/>
<area shape="poly" title=" " alt="" coords="538,33,452,75,450,70,536,28"/>
<area shape="rect" title=" " alt="" coords="5,225,76,251"/>
<area shape="poly" title=" " alt="" coords="485,30,370,47,238,73,175,90,120,109,76,130,47,154,39,167,36,182,37,212,32,212,31,181,35,165,43,150,73,126,118,104,173,85,236,68,369,42,485,25"/>
<area shape="rect" title=" " alt="" coords="641,225,707,251"/>
<area shape="poly" title=" " alt="" coords="569,30,664,212,659,214,564,32"/>
<area shape="rect" title=" " alt="" coords="745,79,840,104"/>
<area shape="poly" title=" " alt="" coords="599,28,743,72,741,77,597,33"/>
<area shape="rect" title=" " alt="" coords="78,152,145,177"/>
<area shape="poly" title=" " alt="" coords="378,104,159,154,158,149,377,99"/>
<area shape="rect" title=" " alt="" coords="169,152,238,177"/>
<area shape="poly" title=" " alt="" coords="382,107,251,150,250,145,380,101"/>
<area shape="poly" title=" " alt="" coords="377,97,301,102,209,112,123,129,90,140,68,154,58,166,51,181,44,212,39,211,46,179,53,163,64,150,88,136,122,124,208,107,301,97,377,92"/>
<area shape="poly" title=" " alt="" coords="454,99,515,119,581,150,623,181,657,213,653,217,619,185,578,154,513,124,453,105"/>
<area shape="rect" title=" " alt="" coords="465,225,529,251"/>
<area shape="poly" title=" " alt="" coords="455,99,497,117,517,132,532,151,537,168,535,185,518,216,514,213,530,183,532,168,528,153,513,136,494,122,452,104"/>
<area shape="rect" title=" " alt="" coords="553,225,617,251"/>
<area shape="poly" title=" " alt="" coords="454,98,505,117,531,131,553,150,573,180,583,211,578,213,568,182,549,154,528,136,503,122,452,103"/>
<area shape="rect" title=" " alt="" coords="219,225,343,251"/>
<area shape="poly" title=" " alt="" coords="378,106,338,124,319,137,303,154,289,182,284,212,279,211,284,180,298,150,315,133,335,120,376,101"/>
<area shape="rect" href="test__environment__state_8hpp.html" title=" " alt="" coords="313,152,518,177"/>
<area shape="poly" title=" " alt="" coords="418,104,418,138,413,138,413,104"/>
<area shape="poly" title=" " alt="" coords="356,180,90,230,89,225,355,175"/>
<area shape="poly" title=" " alt="" coords="458,175,628,221,627,227,456,180"/>
<area shape="poly" title=" " alt="" coords="430,175,475,214,471,218,427,179"/>
<area shape="poly" title=" " alt="" coords="444,175,545,217,543,222,442,180"/>
<area shape="poly" title=" " alt="" coords="395,180,316,221,314,216,392,175"/>
<area shape="rect" title=" " alt="" coords="377,225,440,251"/>
<area shape="poly" title=" " alt="" coords="417,178,414,212,408,212,412,177"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h__dep__incl.png" border="0" usemap="#a_2root_2src_2arch_2arch_8hdep" alt=""/></div>
<map name="a_2root_2src_2arch_2arch_8hdep" id="a_2root_2src_2arch_2arch_8hdep">
<area shape="rect" title=" " alt="" coords="2723,5,2874,31"/>
<area shape="rect" href="aarch64_2arch__main_8cpp.html" title=" " alt="" coords="5,86,168,126"/>
<area shape="poly" title=" " alt="" coords="2709,23,2168,28,1379,39,622,57,344,68,180,81,146,89,145,83,180,76,344,63,622,51,1379,34,2168,23,2709,17"/>
<area shape="rect" href="aarch64_2backtrace_8cpp.html" title=" " alt="" coords="192,86,355,126"/>
<area shape="poly" title=" " alt="" coords="2710,23,1472,41,774,58,518,69,367,81,333,89,332,83,366,76,518,64,774,53,1472,35,2710,18"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html" title=" " alt="" coords="379,86,541,126"/>
<area shape="poly" title=" " alt="" coords="2710,21,2280,21,1655,27,1327,34,1019,45,754,60,554,81,519,89,518,83,553,76,753,55,1019,39,1327,28,1655,21,2280,16,2710,16"/>
<area shape="rect" href="aarch64_2timer_8cpp.html" title=" " alt="" coords="565,86,728,126"/>
<area shape="poly" title=" " alt="" coords="2709,22,2311,22,1741,29,1443,36,1163,47,922,62,740,81,706,89,705,83,740,76,922,57,1163,42,1443,31,1741,24,2311,17,2709,16"/>
<area shape="rect" href="riscv64_2arch__main_8cpp.html" title=" " alt="" coords="753,86,911,126"/>
<area shape="poly" title=" " alt="" coords="2710,22,2343,23,1826,31,1557,38,1304,49,1087,63,923,81,890,89,889,83,922,76,1087,58,1304,44,1557,33,1826,26,2343,18,2710,17"/>
<area shape="rect" href="riscv64_2backtrace_8cpp.html" title=" " alt="" coords="935,86,1094,126"/>
<area shape="poly" title=" " alt="" coords="2710,22,2376,25,1912,34,1446,51,1252,65,1106,81,1073,88,1072,83,1105,76,1252,59,1446,46,1912,28,2375,20,2710,17"/>
<area shape="rect" href="riscv64_2interrupt__main_8cpp.html" title=" " alt="" coords="1118,86,1277,126"/>
<area shape="poly" title=" " alt="" coords="2710,23,2408,27,1997,36,1587,54,1417,66,1288,81,1255,89,1254,83,1288,76,1417,61,1587,48,1997,31,2408,21,2710,17"/>
<area shape="rect" href="riscv64_2timer_8cpp.html" title=" " alt="" coords="1301,86,1459,126"/>
<area shape="poly" title=" " alt="" coords="2710,23,2441,29,2083,39,1729,56,1582,68,1471,81,1438,89,1437,83,1470,76,1582,62,1729,51,2083,34,2441,23,2709,18"/>
<area shape="rect" href="x86__64_2backtrace_8cpp.html" title=" " alt="" coords="1483,86,1623,126"/>
<area shape="poly" title=" " alt="" coords="2710,24,2472,29,2161,40,1857,57,1731,68,1635,81,1606,89,1604,83,1634,76,1730,63,1856,52,2161,35,2471,24,2710,18"/>
<area shape="rect" href="x86__64_2interrupt_8cpp.html" title=" " alt="" coords="1647,86,1782,126"/>
<area shape="poly" title=" " alt="" coords="2710,24,2238,43,1980,59,1874,70,1794,81,1766,88,1764,83,1793,76,1874,64,1980,54,2237,37,2710,19"/>
<area shape="rect" href="x86__64_2interrupt__main_8cpp.html" title=" " alt="" coords="1806,86,1978,126"/>
<area shape="poly" title=" " alt="" coords="2709,23,2570,27,2390,37,2190,54,1990,81,1956,88,1955,83,1989,76,2190,49,2390,32,2570,22,2709,18"/>
<area shape="rect" href="x86__64_2timer_8cpp.html" title=" " alt="" coords="2002,86,2137,126"/>
<area shape="poly" title=" " alt="" coords="2709,24,2596,29,2456,39,2303,56,2150,81,2122,88,2121,83,2149,76,2302,51,2456,34,2596,24,2709,19"/>
<area shape="rect" href="src_2main_8cpp.html" title=" " alt="" coords="2161,93,2300,119"/>
<area shape="poly" title=" " alt="" coords="2710,28,2526,46,2419,61,2313,81,2262,96,2261,91,2311,76,2418,56,2525,41,2710,22"/>
<area shape="rect" href="memory_8cpp.html" title=" " alt="" coords="2325,93,2483,119"/>
<area shape="poly" title=" " alt="" coords="2718,36,2612,56,2495,81,2442,96,2440,91,2494,76,2611,51,2717,31"/>
<area shape="rect" href="schedule_8cpp.html" title=" " alt="" coords="2507,93,2703,119"/>
<area shape="poly" title=" " alt="" coords="2761,39,2633,96,2631,91,2759,34"/>
<area shape="rect" href="task__control__block_8cpp.html" title=" " alt="" coords="2727,86,2870,126"/>
<area shape="poly" title=" " alt="" coords="2801,44,2801,86,2796,86,2796,44"/>
<area shape="rect" href="clone__system__test_8cpp.html" title=" " alt="" coords="2894,86,3101,126"/>
<area shape="poly" title=" " alt="" coords="2839,34,2955,83,2952,88,2837,39"/>
<area shape="rect" href="ctor__dtor__test_8cpp.html" title=" " alt="" coords="3125,86,3299,126"/>
<area shape="poly" title=" " alt="" coords="2880,30,3114,76,3144,83,3143,89,3113,81,2879,36"/>
<area shape="rect" href="exit__system__test_8cpp.html" title=" " alt="" coords="3324,86,3521,126"/>
<area shape="poly" title=" " alt="" coords="2888,24,3083,44,3312,76,3349,83,3348,89,3312,81,3083,49,2887,29"/>
<area shape="rect" href="interrupt__test_8cpp.html" title=" " alt="" coords="3545,86,3719,126"/>
<area shape="poly" title=" " alt="" coords="2888,19,3176,34,3355,51,3534,76,3568,83,3567,89,3533,81,3354,56,3176,40,2888,24"/>
<area shape="rect" href="kernel__task__test_8cpp.html" title=" " alt="" coords="3743,86,3935,126"/>
<area shape="poly" title=" " alt="" coords="2888,17,3046,21,3256,30,3493,48,3731,76,3769,83,3768,89,3730,81,3492,53,3256,35,3046,26,2888,23"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html" title=" " alt="" coords="3959,86,4099,126"/>
<area shape="poly" title=" " alt="" coords="2888,18,3428,35,3729,52,3853,63,3947,76,3978,83,3976,89,3946,81,3852,69,3728,58,3428,41,2888,24"/>
<area shape="rect" href="memory__test_8cpp.html" title=" " alt="" coords="4123,86,4295,126"/>
<area shape="poly" title=" " alt="" coords="2888,18,3507,35,3857,52,4002,63,4112,76,4148,83,4147,89,4112,81,4002,69,3857,58,3507,41,2888,24"/>
<area shape="rect" href="system__test_2sk__list__test_8cpp.html" title=" " alt="" coords="4319,86,4478,126"/>
<area shape="poly" title=" " alt="" coords="2888,17,3190,21,3600,31,4009,49,4180,61,4308,76,4342,83,4341,89,4308,81,4179,66,4009,54,3600,36,3190,27,2888,23"/>
<area shape="rect" href="system__test_2sk__unordered__map__test_8cpp.html" title=" " alt="" coords="4502,79,4685,133"/>
<area shape="poly" title=" " alt="" coords="2888,17,3221,21,3685,31,4150,48,4344,61,4491,76,4502,78,4501,83,4490,81,4344,66,4150,54,3685,36,3221,27,2887,23"/>
<area shape="rect" href="system__test_2sk__vector__test_8cpp.html" title=" " alt="" coords="4709,86,4889,126"/>
<area shape="poly" title=" " alt="" coords="2888,17,3258,19,3781,28,4310,46,4531,59,4698,76,4735,83,4734,88,4697,81,4530,64,4310,51,3781,33,3258,25,2888,22"/>
<area shape="rect" href="thread__group__system__test_8cpp.html" title=" " alt="" coords="4913,79,5111,133"/>
<area shape="poly" title=" " alt="" coords="2888,17,3293,19,3876,27,4468,45,4715,59,4902,76,4913,78,4912,83,4901,81,4714,64,4467,50,3876,33,3293,24,2888,22"/>
<area shape="rect" href="user__task__test_8cpp.html" title=" " alt="" coords="5135,86,5315,126"/>
<area shape="poly" title=" " alt="" coords="2888,16,3331,16,3979,22,4319,30,4640,40,4916,56,5124,76,5162,83,5161,89,5124,81,4916,61,4639,46,4319,35,3979,28,3331,22,2888,22"/>
<area shape="rect" href="system__test_2virtual__memory__test_8cpp.html" title=" " alt="" coords="5340,79,5503,133"/>
<area shape="poly" title=" " alt="" coords="2888,17,4175,35,4903,52,5170,63,5328,76,5340,78,5339,83,5328,81,5170,69,4903,57,4174,40,2888,23"/>
<area shape="rect" href="wait__system__test_8cpp.html" title=" " alt="" coords="5527,86,5727,126"/>
<area shape="poly" title=" " alt="" coords="2888,18,4267,36,5054,53,5344,64,5515,76,5556,83,5556,89,5514,81,5344,69,5054,59,4267,41,2888,23"/>
<area shape="rect" href="task__scheduling__example__test_8cpp.html" title=" " alt="" coords="5751,79,5913,133"/>
<area shape="poly" title=" " alt="" coords="2888,17,3487,21,4378,32,5237,49,5553,61,5739,76,5751,78,5750,83,5738,81,5552,67,5237,55,4378,37,3487,27,2888,22"/>
</map>
</div>
</div>
<p><a href="arch_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1a5356ccbae40313871a4877d89cc53d" id="r_a1a5356ccbae40313871a4877d89cc53d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a1a5356ccbae40313871a4877d89cc53d">switch_to</a> (<a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *prev, <a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *next)</td></tr>
<tr class="separator:a1a5356ccbae40313871a4877d89cc53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7241001f2323bd5690c3ee10606fb8c4" id="r_a7241001f2323bd5690c3ee10606fb8c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a7241001f2323bd5690c3ee10606fb8c4">kernel_thread_entry</a> ()</td></tr>
<tr class="separator:a7241001f2323bd5690c3ee10606fb8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdf04695210228502c6042c9f530faf1" id="r_acdf04695210228502c6042c9f530faf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#acdf04695210228502c6042c9f530faf1">trap_return</a> (void *)</td></tr>
<tr class="separator:acdf04695210228502c6042c9f530faf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73d8c3647dca189d5c572ba9c48f471" id="r_ac73d8c3647dca189d5c572ba9c48f471"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ac73d8c3647dca189d5c572ba9c48f471">trap_entry</a> ()</td></tr>
<tr class="separator:ac73d8c3647dca189d5c572ba9c48f471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26c42c34bbb6c8c7cd4a8664dc7952f" id="r_aa26c42c34bbb6c8c7cd4a8664dc7952f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#aa26c42c34bbb6c8c7cd4a8664dc7952f">ArchInit</a> (int argc, const char **argv)</td></tr>
<tr class="separator:aa26c42c34bbb6c8c7cd4a8664dc7952f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac930f945a422e93db87e2c85d93b8aef" id="r_ac930f945a422e93db87e2c85d93b8aef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ac930f945a422e93db87e2c85d93b8aef">ArchInitSMP</a> (int argc, const char **argv)</td></tr>
<tr class="separator:ac930f945a422e93db87e2c85d93b8aef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c31dc3a1de17229bc6863fff8eddd7" id="r_a94c31dc3a1de17229bc6863fff8eddd7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a94c31dc3a1de17229bc6863fff8eddd7">WakeUpOtherCores</a> ()</td></tr>
<tr class="separator:a94c31dc3a1de17229bc6863fff8eddd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27506b04ac03abcaede4a6a9863c1ac0" id="r_a27506b04ac03abcaede4a6a9863c1ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a27506b04ac03abcaede4a6a9863c1ac0">InterruptInit</a> (int argc, const char **argv)</td></tr>
<tr class="separator:a27506b04ac03abcaede4a6a9863c1ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790bd86205392967bd3fbc5533fbb144" id="r_a790bd86205392967bd3fbc5533fbb144"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a790bd86205392967bd3fbc5533fbb144">InterruptInitSMP</a> (int argc, const char **argv)</td></tr>
<tr class="separator:a790bd86205392967bd3fbc5533fbb144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8febf243f0581d61474fd6b56cfdb544" id="r_a8febf243f0581d61474fd6b56cfdb544"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a8febf243f0581d61474fd6b56cfdb544">TimerInit</a> ()</td></tr>
<tr class="separator:a8febf243f0581d61474fd6b56cfdb544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b082ebd75de9086c93c05ad124fc8c" id="r_a85b082ebd75de9086c93c05ad124fc8c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a85b082ebd75de9086c93c05ad124fc8c">TimerInitSMP</a> ()</td></tr>
<tr class="separator:a85b082ebd75de9086c93c05ad124fc8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13c92ba83f807779913f45bc9ac404b0" id="r_a13c92ba83f807779913f45bc9ac404b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a13c92ba83f807779913f45bc9ac404b0">InitTaskContext</a> (<a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *task_context, void(*<a class="el" href="acpi_8h.html#a9f4b9757ed06b7cffea1bd7b35f6c093">entry</a>)(void *), void *arg, uint64_t stack_top)</td></tr>
<tr class="separator:a13c92ba83f807779913f45bc9ac404b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68bd5f23f249b2c277d460dc2e2ee47a" id="r_a68bd5f23f249b2c277d460dc2e2ee47a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a68bd5f23f249b2c277d460dc2e2ee47a">InitTaskContext</a> (<a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *task_context, <a class="el" href="structcpu__io_1_1TrapContext.html">cpu_io::TrapContext</a> *trap_context_ptr, uint64_t stack_top)</td></tr>
<tr class="separator:a68bd5f23f249b2c277d460dc2e2ee47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560d6c985b03fa37322dac744aa27d01" id="r_a560d6c985b03fa37322dac744aa27d01"><td class="memItemLeft" align="right" valign="top">__always_inline auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a560d6c985b03fa37322dac744aa27d01">backtrace</a> (void **buffer, int size) -&gt; int</td></tr>
<tr class="separator:a560d6c985b03fa37322dac744aa27d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8446673829abff96859f4f7fef26c6fc" id="r_a8446673829abff96859f4f7fef26c6fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a8446673829abff96859f4f7fef26c6fc">DumpStack</a> ()</td></tr>
<tr class="separator:a8446673829abff96859f4f7fef26c6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa6bf08e475b70fd9c9f5c7c5dbb04fac" id="r_aa6bf08e475b70fd9c9f5c7c5dbb04fac"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#aa6bf08e475b70fd9c9f5c7c5dbb04fac">kMaxFrameCount</a> = 128</td></tr>
<tr class="memdesc:aa6bf08e475b70fd9c9f5c7c5dbb04fac"><td class="mdescLeft">&#160;</td><td class="mdescRight">最多回溯 128 层调用栈  <br /></td></tr>
<tr class="separator:aa6bf08e475b70fd9c9f5c7c5dbb04fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa26c42c34bbb6c8c7cd4a8664dc7952f" name="aa26c42c34bbb6c8c7cd4a8664dc7952f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa26c42c34bbb6c8c7cd4a8664dc7952f">&#9670;&#160;</a></span>ArchInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ArchInit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>体系结构相关初始化 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>在不同体系结构有不同含义，同 _start </td></tr>
    <tr><td class="paramname">argv</td><td>在不同体系结构有不同含义，同 _start </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="aarch64_2arch__main_8cpp_source.html#l00047">47</a> of file <a class="el" href="aarch64_2arch__main_8cpp_source.html">arch_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                                           {</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;KernelFdt&gt;::GetInstance</a>() =</div>
<div class="line"><span class="lineno">   49</span>      <a class="code hl_class" href="classKernelFdt.html">KernelFdt</a>(<a class="code hl_define" href="sk__libc__test_8cpp.html#acbc25345a39784031ea891c317ab6f4e">strtoull</a>(argv[2], <span class="keyword">nullptr</span>, 16));</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;BasicInfo&gt;::GetInstance</a>() = <a class="code hl_struct" href="structBasicInfo.html">BasicInfo</a>(argc, argv);</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="comment">// 解析内核 elf 信息</span></div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;KernelElf&gt;::GetInstance</a>() =</div>
<div class="line"><span class="lineno">   55</span>      <a class="code hl_class" href="classKernelElf.html">KernelElf</a>(<a class="code hl_class" href="classSingleton.html">Singleton&lt;BasicInfo&gt;::GetInstance</a>().elf_addr);</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  sk_std::cout &lt;&lt; Singleton&lt;BasicInfo&gt;::GetInstance();</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;KernelFdt&gt;::GetInstance</a>().CheckPSCI().or_else(</div>
<div class="line"><span class="lineno">   60</span>      [](<a class="code hl_struct" href="structError.html">Error</a> err) -&gt; <a class="code hl_typedef" href="expected_8hpp.html#a87330dc74eb67e824914b8d343050757">Expected&lt;void&gt;</a> {</div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_struct" href="structklog_1_1Err.html">klog::Err</a>(<span class="stringliteral">&quot;CheckPSCI failed: %s\n&quot;</span>, err.<a class="code hl_function" href="structError.html#aa63ee10532d668f25a5147d7dc753749">message</a>());</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">   63</span>      });</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_struct" href="structklog_1_1Info.html">klog::Info</a>(<span class="stringliteral">&quot;Hello aarch64 ArchInit\n&quot;</span>);</div>
<div class="line"><span class="lineno">   66</span>}</div>
<div class="ttc" id="aclassKernelElf_html"><div class="ttname"><a href="classKernelElf.html">KernelElf</a></div><div class="ttdef"><b>Definition</b> <a href="kernel__elf_8hpp_source.html#l00023">kernel_elf.hpp:23</a></div></div>
<div class="ttc" id="aclassKernelFdt_html"><div class="ttname"><a href="classKernelFdt.html">KernelFdt</a></div><div class="ttdef"><b>Definition</b> <a href="kernel__fdt_8hpp_source.html#l00034">kernel_fdt.hpp:34</a></div></div>
<div class="ttc" id="aclassSingleton_html"><div class="ttname"><a href="classSingleton.html">Singleton</a></div><div class="ttdef"><b>Definition</b> <a href="singleton_8hpp_source.html#l00010">singleton.hpp:10</a></div></div>
<div class="ttc" id="aclassSingleton_html_a68856b49e098eadba37b60366db33ebd"><div class="ttname"><a href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton::GetInstance</a></div><div class="ttdeci">static auto GetInstance() -&gt; T &amp;</div><div class="ttdef"><b>Definition</b> <a href="singleton_8hpp_source.html#l00023">singleton.hpp:23</a></div></div>
<div class="ttc" id="aexpected_8hpp_html_a87330dc74eb67e824914b8d343050757"><div class="ttname"><a href="expected_8hpp.html#a87330dc74eb67e824914b8d343050757">Expected</a></div><div class="ttdeci">std::expected&lt; T, Error &gt; Expected</div><div class="ttdoc">std::expected 别名模板</div><div class="ttdef"><b>Definition</b> <a href="expected_8hpp_source.html#l00162">expected.hpp:162</a></div></div>
<div class="ttc" id="ask__libc__test_8cpp_html_acbc25345a39784031ea891c317ab6f4e"><div class="ttname"><a href="sk__libc__test_8cpp.html#acbc25345a39784031ea891c317ab6f4e">strtoull</a></div><div class="ttdeci">#define strtoull</div><div class="ttdef"><b>Definition</b> <a href="sk__libc__test_8cpp_source.html#l00018">sk_libc_test.cpp:18</a></div></div>
<div class="ttc" id="astructBasicInfo_html"><div class="ttname"><a href="structBasicInfo.html">BasicInfo</a></div><div class="ttdef"><b>Definition</b> <a href="basic__info_8hpp_source.html#l00026">basic_info.hpp:26</a></div></div>
<div class="ttc" id="astructError_html"><div class="ttname"><a href="structError.html">Error</a></div><div class="ttdef"><b>Definition</b> <a href="expected_8hpp_source.html#l00150">expected.hpp:150</a></div></div>
<div class="ttc" id="astructError_html_aa63ee10532d668f25a5147d7dc753749"><div class="ttname"><a href="structError.html#aa63ee10532d668f25a5147d7dc753749">Error::message</a></div><div class="ttdeci">constexpr auto message() const -&gt; const char *</div><div class="ttdef"><b>Definition</b> <a href="expected_8hpp_source.html#l00155">expected.hpp:155</a></div></div>
<div class="ttc" id="astructklog_1_1Err_html"><div class="ttname"><a href="structklog_1_1Err.html">klog::Err</a></div><div class="ttdef"><b>Definition</b> <a href="kernel__log_8hpp_source.html#l00188">kernel_log.hpp:188</a></div></div>
<div class="ttc" id="astructklog_1_1Info_html"><div class="ttname"><a href="structklog_1_1Info.html">klog::Info</a></div><div class="ttdef"><b>Definition</b> <a href="kernel__log_8hpp_source.html#l00168">kernel_log.hpp:168</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_cgraph.png" border="0" usemap="#aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_cgraph" alt=""/></div>
<map name="aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_cgraph" id="aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,77,80"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="125,5,295,31"/>
<area shape="poly" title=" " alt="" coords="77,54,125,39,150,32,152,37,126,45,78,59"/>
<area shape="rect" href="structError.html#aa63ee10532d668f25a5147d7dc753749" title=" " alt="" coords="150,55,270,80"/>
<area shape="poly" title=" " alt="" coords="77,65,136,65,136,70,77,70"/>
<area shape="rect" href="namespacecpu__io.html#acf7d7c3a4a0720cfd4f57914b52c7e9b" title=" " alt="" coords="155,104,265,129"/>
<area shape="poly" title=" " alt="" coords="78,75,153,97,152,103,77,80"/>
<area shape="rect" href="expected_8hpp.html#a707ff37b9c7f7c83cf7f984840fa7a16" title="获取错误码对应的错误信息" alt="" coords="343,55,477,80"/>
<area shape="poly" title=" " alt="" coords="270,65,329,65,329,70,270,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_icgraph.png" border="0" usemap="#aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_icgraph" alt=""/></div>
<map name="aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_icgraph" id="aarch_8h_aa26c42c34bbb6c8c7cd4a8664dc7952f_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,180,31"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html#ab85c3edfd2aada0e059dccf8d002924d" title="内核入口" alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="ac930f945a422e93db87e2c85d93b8aef" name="ac930f945a422e93db87e2c85d93b8aef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac930f945a422e93db87e2c85d93b8aef">&#9670;&#160;</a></span>ArchInitSMP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ArchInitSMP </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aarch64_2arch__main_8cpp_source.html#l00068">68</a> of file <a class="el" href="aarch64_2arch__main_8cpp_source.html">arch_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>{}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_ac930f945a422e93db87e2c85d93b8aef_cgraph.png" border="0" usemap="#aarch_8h_ac930f945a422e93db87e2c85d93b8aef_cgraph" alt=""/></div>
<map name="aarch_8h_ac930f945a422e93db87e2c85d93b8aef_cgraph" id="aarch_8h_ac930f945a422e93db87e2c85d93b8aef_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,105,80"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="153,5,323,31"/>
<area shape="poly" title=" " alt="" coords="102,52,176,32,178,37,104,57"/>
<area shape="rect" href="structError.html#aa63ee10532d668f25a5147d7dc753749" title=" " alt="" coords="178,55,298,80"/>
<area shape="poly" title=" " alt="" coords="105,65,164,65,164,70,105,70"/>
<area shape="rect" href="namespacecpu__io.html#acf7d7c3a4a0720cfd4f57914b52c7e9b" title=" " alt="" coords="183,104,293,129"/>
<area shape="poly" title=" " alt="" coords="104,77,178,98,176,103,102,83"/>
<area shape="rect" href="expected_8hpp.html#a707ff37b9c7f7c83cf7f984840fa7a16" title="获取错误码对应的错误信息" alt="" coords="371,55,505,80"/>
<area shape="poly" title=" " alt="" coords="298,65,357,65,357,70,298,70"/>
</map>
</div>

</div>
</div>
<a id="a560d6c985b03fa37322dac744aa27d01" name="a560d6c985b03fa37322dac744aa27d01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a560d6c985b03fa37322dac744aa27d01">&#9670;&#160;</a></span>backtrace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__always_inline auto backtrace </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt;  int</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>获取调用栈 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>指向一个数组，该数组用于存储调用栈中的返回地址 </td></tr>
    <tr><td class="paramname">size</td><td>数组的大小，即调用栈中最多存储多少个返回地址 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 成功时返回实际写入数组中的地址数量，失败时返回 -1 </dd></dl>

</div>
</div>
<a id="a8446673829abff96859f4f7fef26c6fc" name="a8446673829abff96859f4f7fef26c6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8446673829abff96859f4f7fef26c6fc">&#9670;&#160;</a></span>DumpStack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DumpStack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>打印调用栈 </p>

<p class="definition">Definition at line <a class="el" href="aarch64_2backtrace_8cpp_source.html#l00034">34</a> of file <a class="el" href="aarch64_2backtrace_8cpp_source.html">backtrace.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>                 {</div>
<div class="line"><span class="lineno">   35</span>  std::array&lt;uint64_t, kMaxFrameCount&gt; buffer{};</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  <span class="comment">// 获取调用栈中的地址</span></div>
<div class="line"><span class="lineno">   38</span>  <span class="keyword">auto</span> num_frames = <a class="code hl_function" href="aarch64_2backtrace_8cpp.html#a7986cc449f6e96ca1ee111a6ee7940bb">backtrace</a>(buffer);</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="comment">// 打印函数名</span></div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> current_frame_idx = 0; current_frame_idx &lt; num_frames;</div>
<div class="line"><span class="lineno">   42</span>       current_frame_idx++) {</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> symtab : <a class="code hl_class" href="classSingleton.html">Singleton</a>&lt;<a class="code hl_class" href="classKernelElf.html">KernelElf</a>&gt;::GetInstance().symtab_) {</div>
<div class="line"><span class="lineno">   44</span>      <span class="keywordflow">if</span> ((ELF64_ST_TYPE(symtab.st_info) == STT_FUNC) &amp;&amp;</div>
<div class="line"><span class="lineno">   45</span>          (buffer[current_frame_idx] &gt;= symtab.st_value) &amp;&amp;</div>
<div class="line"><span class="lineno">   46</span>          (buffer[current_frame_idx] &lt;= symtab.st_value + symtab.st_size)) {</div>
<div class="line"><span class="lineno">   47</span>        <a class="code hl_struct" href="structklog_1_1Err.html">klog::Err</a>(<span class="stringliteral">&quot;[%s] 0x%p\n&quot;</span>,</div>
<div class="line"><span class="lineno">   48</span>                  <a class="code hl_class" href="classSingleton.html">Singleton&lt;KernelElf&gt;::GetInstance</a>().strtab_ + symtab.st_name,</div>
<div class="line"><span class="lineno">   49</span>                  buffer[current_frame_idx]);</div>
<div class="line"><span class="lineno">   50</span>      }</div>
<div class="line"><span class="lineno">   51</span>    }</div>
<div class="line"><span class="lineno">   52</span>  }</div>
<div class="line"><span class="lineno">   53</span>}</div>
<div class="ttc" id="aaarch64_2backtrace_8cpp_html_a7986cc449f6e96ca1ee111a6ee7940bb"><div class="ttname"><a href="aarch64_2backtrace_8cpp.html#a7986cc449f6e96ca1ee111a6ee7940bb">backtrace</a></div><div class="ttdeci">__always_inline auto backtrace(std::array&lt; uint64_t, kMaxFrameCount &gt; &amp;buffer) -&gt; int</div><div class="ttdef"><b>Definition</b> <a href="aarch64_2backtrace_8cpp_source.html#l00018">backtrace.cpp:18</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a8446673829abff96859f4f7fef26c6fc_cgraph.png" border="0" usemap="#aarch_8h_a8446673829abff96859f4f7fef26c6fc_cgraph" alt=""/></div>
<map name="aarch_8h_a8446673829abff96859f4f7fef26c6fc_cgraph" id="aarch_8h_a8446673829abff96859f4f7fef26c6fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,103,56"/>
<area shape="rect" href="aarch64_2backtrace_8cpp.html#a7986cc449f6e96ca1ee111a6ee7940bb" title=" " alt="" coords="192,5,279,31"/>
<area shape="poly" title=" " alt="" coords="102,34,178,23,179,29,103,39"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="151,55,320,80"/>
<area shape="poly" title=" " alt="" coords="103,47,137,52,137,57,102,52"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a8446673829abff96859f4f7fef26c6fc_icgraph.png" border="0" usemap="#aarch_8h_a8446673829abff96859f4f7fef26c6fc_icgraph" alt=""/></div>
<map name="aarch_8h_a8446673829abff96859f4f7fef26c6fc_icgraph" id="aarch_8h_a8446673829abff96859f4f7fef26c6fc_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,205,31"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html#ab85c3edfd2aada0e059dccf8d002924d" title="内核入口" alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="a68bd5f23f249b2c277d460dc2e2ee47a" name="a68bd5f23f249b2c277d460dc2e2ee47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68bd5f23f249b2c277d460dc2e2ee47a">&#9670;&#160;</a></span>InitTaskContext() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitTaskContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *&#160;</td>
          <td class="paramname"><em>task_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcpu__io_1_1TrapContext.html">cpu_io::TrapContext</a> *&#160;</td>
          <td class="paramname"><em>trap_context_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>stack_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>初始化用户线程的任务上下文（重载2） </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">task_context</td><td>指向任务上下文的指针 </td></tr>
    <tr><td class="paramname">trap_context_ptr</td><td>指向 Trap 上下文的指针 </td></tr>
    <tr><td class="paramname">stack_top</td><td>内核栈顶地址 </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>x86_64 实现待补充 </dd></dl>

<p class="definition">Definition at line <a class="el" href="aarch64_2arch__main_8cpp_source.html#l00091">91</a> of file <a class="el" href="aarch64_2arch__main_8cpp_source.html">arch_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>                                         {</div>
<div class="line"><span class="lineno">   94</span>  <span class="comment">// 清零上下文</span></div>
<div class="line"><span class="lineno">   95</span>  std::memset(task_context, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a>));</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a4dc21308ff38303ff2484b49c84daa2d">ReturnAddress</a>() =</div>
<div class="line"><span class="lineno">   98</span>      <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="arch_8h.html#a7241001f2323bd5690c3ee10606fb8c4">kernel_thread_entry</a>);</div>
<div class="line"><span class="lineno">   99</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a057438d663910d4cb7abcbb5615397ab">EntryFunction</a>() = <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="arch_8h.html#acdf04695210228502c6042c9f530faf1">trap_return</a>);</div>
<div class="line"><span class="lineno">  100</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a1ae45175010d9b66ef6db82b668baa1d">EntryArgument</a>() = <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(trap_context_ptr);</div>
<div class="line"><span class="lineno">  101</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a90361985987010520dd23face113731f">StackPointer</a>() = stack_top;</div>
<div class="line"><span class="lineno">  102</span>}</div>
<div class="ttc" id="aarch_8h_html_a7241001f2323bd5690c3ee10606fb8c4"><div class="ttname"><a href="arch_8h.html#a7241001f2323bd5690c3ee10606fb8c4">kernel_thread_entry</a></div><div class="ttdeci">void kernel_thread_entry()</div><div class="ttdef"><b>Definition</b> <a href="arch_8cpp_source.html#l00044">arch.cpp:44</a></div></div>
<div class="ttc" id="aarch_8h_html_acdf04695210228502c6042c9f530faf1"><div class="ttname"><a href="arch_8h.html#acdf04695210228502c6042c9f530faf1">trap_return</a></div><div class="ttdeci">void trap_return(void *)</div><div class="ttdef"><b>Definition</b> <a href="arch_8cpp_source.html#l00045">arch.cpp:45</a></div></div>
<div class="ttc" id="astructcpu__io_1_1CalleeSavedContext_html"><div class="ttname"><a href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a></div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00194">cpu_io.h:194</a></div></div>
<div class="ttc" id="astructcpu__io_1_1CalleeSavedContext_html_a057438d663910d4cb7abcbb5615397ab"><div class="ttname"><a href="structcpu__io_1_1CalleeSavedContext.html#a057438d663910d4cb7abcbb5615397ab">cpu_io::CalleeSavedContext::EntryFunction</a></div><div class="ttdeci">__always_inline uint64_t &amp; EntryFunction()</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00203">cpu_io.h:203</a></div></div>
<div class="ttc" id="astructcpu__io_1_1CalleeSavedContext_html_a1ae45175010d9b66ef6db82b668baa1d"><div class="ttname"><a href="structcpu__io_1_1CalleeSavedContext.html#a1ae45175010d9b66ef6db82b668baa1d">cpu_io::CalleeSavedContext::EntryArgument</a></div><div class="ttdeci">__always_inline uint64_t &amp; EntryArgument()</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00204">cpu_io.h:204</a></div></div>
<div class="ttc" id="astructcpu__io_1_1CalleeSavedContext_html_a4dc21308ff38303ff2484b49c84daa2d"><div class="ttname"><a href="structcpu__io_1_1CalleeSavedContext.html#a4dc21308ff38303ff2484b49c84daa2d">cpu_io::CalleeSavedContext::ReturnAddress</a></div><div class="ttdeci">__always_inline uint64_t &amp; ReturnAddress()</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00202">cpu_io.h:202</a></div></div>
<div class="ttc" id="astructcpu__io_1_1CalleeSavedContext_html_a90361985987010520dd23face113731f"><div class="ttname"><a href="structcpu__io_1_1CalleeSavedContext.html#a90361985987010520dd23face113731f">cpu_io::CalleeSavedContext::StackPointer</a></div><div class="ttdeci">__always_inline uint64_t &amp; StackPointer()</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00205">cpu_io.h:205</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a68bd5f23f249b2c277d460dc2e2ee47a_cgraph.png" border="0" usemap="#aarch_8h_a68bd5f23f249b2c277d460dc2e2ee47a_cgraph" alt=""/></div>
<map name="aarch_8h_a68bd5f23f249b2c277d460dc2e2ee47a_cgraph" id="aarch_8h_a68bd5f23f249b2c277d460dc2e2ee47a_cgraph">
<area shape="rect" title=" " alt="" coords="5,163,128,189"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a1ae45175010d9b66ef6db82b668baa1d" title=" " alt="" coords="176,5,380,45"/>
<area shape="poly" title=" " alt="" coords="74,162,113,110,142,81,175,55,185,49,188,53,177,60,145,85,117,114,78,165"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a057438d663910d4cb7abcbb5615397ab" title=" " alt="" coords="176,69,380,109"/>
<area shape="poly" title=" " alt="" coords="89,161,175,119,195,111,197,116,177,124,92,166"/>
<area shape="rect" href="arch_8cpp.html#a7241001f2323bd5690c3ee10606fb8c4" title=" " alt="" coords="202,134,354,159"/>
<area shape="poly" title=" " alt="" coords="128,165,188,156,189,162,129,170"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a4dc21308ff38303ff2484b49c84daa2d" title=" " alt="" coords="176,184,380,224"/>
<area shape="poly" title=" " alt="" coords="129,181,163,186,162,191,128,187"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a90361985987010520dd23face113731f" title=" " alt="" coords="176,248,380,288"/>
<area shape="poly" title=" " alt="" coords="89,186,129,210,177,234,195,241,193,246,175,238,127,214,87,191"/>
<area shape="rect" href="arch_8cpp.html#acdf04695210228502c6042c9f530faf1" title=" " alt="" coords="231,313,325,338"/>
<area shape="poly" title=" " alt="" coords="78,187,116,241,144,272,177,298,218,314,216,319,175,302,141,276,112,245,73,190"/>
</map>
</div>

</div>
</div>
<a id="a13c92ba83f807779913f45bc9ac404b0" name="a13c92ba83f807779913f45bc9ac404b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13c92ba83f807779913f45bc9ac404b0">&#9670;&#160;</a></span>InitTaskContext() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitTaskContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *&#160;</td>
          <td class="paramname"><em>task_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>stack_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>初始化内核线程的任务上下文（重载1） </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">task_context</td><td>指向任务上下文的指针 </td></tr>
    <tr><td class="paramname">entry</td><td>线程入口函数 </td></tr>
    <tr><td class="paramname">arg</td><td>传递给线程的参数 </td></tr>
    <tr><td class="paramname">stack_top</td><td>内核栈顶地址 </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>x86_64 实现待补充 </dd></dl>

<p class="definition">Definition at line <a class="el" href="aarch64_2arch__main_8cpp_source.html#l00079">79</a> of file <a class="el" href="aarch64_2arch__main_8cpp_source.html">arch_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>                                                                          {</div>
<div class="line"><span class="lineno">   81</span>  <span class="comment">// 清零上下文</span></div>
<div class="line"><span class="lineno">   82</span>  std::memset(task_context, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a>));</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a4dc21308ff38303ff2484b49c84daa2d">ReturnAddress</a>() =</div>
<div class="line"><span class="lineno">   85</span>      <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="arch_8h.html#a7241001f2323bd5690c3ee10606fb8c4">kernel_thread_entry</a>);</div>
<div class="line"><span class="lineno">   86</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a057438d663910d4cb7abcbb5615397ab">EntryFunction</a>() = <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_variable" href="acpi_8h.html#a9f4b9757ed06b7cffea1bd7b35f6c093">entry</a>);</div>
<div class="line"><span class="lineno">   87</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a1ae45175010d9b66ef6db82b668baa1d">EntryArgument</a>() = <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(arg);</div>
<div class="line"><span class="lineno">   88</span>  task_context-&gt;<a class="code hl_function" href="structcpu__io_1_1CalleeSavedContext.html#a90361985987010520dd23face113731f">StackPointer</a>() = stack_top;</div>
<div class="line"><span class="lineno">   89</span>}</div>
<div class="ttc" id="aacpi_8h_html_a9f4b9757ed06b7cffea1bd7b35f6c093"><div class="ttname"><a href="acpi_8h.html#a9f4b9757ed06b7cffea1bd7b35f6c093">entry</a></div><div class="ttdeci">uint32_t * entry</div><div class="ttdef"><b>Definition</b> <a href="acpi_8h_source.html#l00001">acpi.h:1</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a13c92ba83f807779913f45bc9ac404b0_cgraph.png" border="0" usemap="#aarch_8h_a13c92ba83f807779913f45bc9ac404b0_cgraph" alt=""/></div>
<map name="aarch_8h_a13c92ba83f807779913f45bc9ac404b0_cgraph" id="aarch_8h_a13c92ba83f807779913f45bc9ac404b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,134,128,159"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a1ae45175010d9b66ef6db82b668baa1d" title=" " alt="" coords="176,5,380,45"/>
<area shape="poly" title=" " alt="" coords="78,132,119,94,175,55,188,48,191,53,177,60,122,98,82,136"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a057438d663910d4cb7abcbb5615397ab" title=" " alt="" coords="176,69,380,109"/>
<area shape="poly" title=" " alt="" coords="114,131,190,110,191,116,115,137"/>
<area shape="rect" href="arch_8cpp.html#a7241001f2323bd5690c3ee10606fb8c4" title=" " alt="" coords="202,134,354,159"/>
<area shape="poly" title=" " alt="" coords="128,144,188,144,188,149,128,149"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a4dc21308ff38303ff2484b49c84daa2d" title=" " alt="" coords="176,184,380,224"/>
<area shape="poly" title=" " alt="" coords="115,157,191,178,190,183,114,162"/>
<area shape="rect" href="structcpu__io_1_1CalleeSavedContext.html#a90361985987010520dd23face113731f" title=" " alt="" coords="176,248,380,288"/>
<area shape="poly" title=" " alt="" coords="82,157,122,195,177,234,191,240,188,245,175,238,119,199,78,161"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a13c92ba83f807779913f45bc9ac404b0_icgraph.png" border="0" usemap="#aarch_8h_a13c92ba83f807779913f45bc9ac404b0_icgraph" alt=""/></div>
<map name="aarch_8h_a13c92ba83f807779913f45bc9ac404b0_icgraph" id="aarch_8h_a13c92ba83f807779913f45bc9ac404b0_icgraph">
<area shape="rect" title=" " alt="" coords="272,13,395,38"/>
<area shape="rect" href="structTaskControlBlock.html#a6e96afd7da4feb231b605e2b7cebfc42" title="构造函数 (内核线程)" alt="" coords="5,5,224,45"/>
<area shape="poly" title=" " alt="" coords="258,28,224,28,224,23,258,23"/>
</map>
</div>

</div>
</div>
<a id="a27506b04ac03abcaede4a6a9863c1ac0" name="a27506b04ac03abcaede4a6a9863c1ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27506b04ac03abcaede4a6a9863c1ac0">&#9670;&#160;</a></span>InterruptInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InterruptInit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>体系结构相关中断初始化 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>在不同体系结构有不同含义，同 _start </td></tr>
    <tr><td class="paramname">argv</td><td>在不同体系结构有不同含义，同 _start </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="aarch64_2interrupt__main_8cpp_source.html#l00146">146</a> of file <a class="el" href="aarch64_2interrupt__main_8cpp_source.html">interrupt_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  146</span>                                      {</div>
<div class="line"><span class="lineno">  147</span>  cpu_io::VBAR_EL1::Write(<span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="aarch64_2interrupt__main_8cpp.html#a2a09df74b4cb8ba4d0fe481aaa679816">vector_table</a>));</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <span class="keyword">auto</span> uart_intid =</div>
<div class="line"><span class="lineno">  150</span>      <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;KernelFdt&gt;::GetInstance</a>().GetAarch64Intid(<span class="stringliteral">&quot;arm,pl011&quot;</span>).value() +</div>
<div class="line"><span class="lineno">  151</span>      <a class="code hl_variable" href="classGic.html#a4cce758a89d33ca112a0c42d162fed99">Gic::kSPIBase</a>;</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <a class="code hl_struct" href="structklog_1_1Info.html">klog::Info</a>(<span class="stringliteral">&quot;uart_intid: %d\n&quot;</span>, uart_intid);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().SPI(uart_intid,</div>
<div class="line"><span class="lineno">  156</span>                                          <a class="code hl_function" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72">cpu_io::GetCurrentCoreId</a>());</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <span class="comment">// 注册 uart 中断处理函数</span></div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().RegisterInterruptFunc(uart_intid,</div>
<div class="line"><span class="lineno">  160</span>                                                            <a class="code hl_function" href="aarch64_2interrupt__main_8cpp.html#afeb27dda805c973ef825d7f26ea196c8">uart_handler</a>);</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_function" href="namespacecpu__io.html#afe7f925ac3cb632ed212166712288451">cpu_io::EnableInterrupt</a>();</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="comment">// 初始化定时器</span></div>
<div class="line"><span class="lineno">  165</span>  <a class="code hl_function" href="aarch64_2timer_8cpp.html#a8febf243f0581d61474fd6b56cfdb544">TimerInit</a>();</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <a class="code hl_struct" href="structklog_1_1Info.html">klog::Info</a>(<span class="stringliteral">&quot;Hello InterruptInit\n&quot;</span>);</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="aaarch64_2interrupt__main_8cpp_html_a2a09df74b4cb8ba4d0fe481aaa679816"><div class="ttname"><a href="aarch64_2interrupt__main_8cpp.html#a2a09df74b4cb8ba4d0fe481aaa679816">vector_table</a></div><div class="ttdeci">void vector_table()</div><div class="ttdoc">中断处理函数</div></div>
<div class="ttc" id="aaarch64_2interrupt__main_8cpp_html_afeb27dda805c973ef825d7f26ea196c8"><div class="ttname"><a href="aarch64_2interrupt__main_8cpp.html#afeb27dda805c973ef825d7f26ea196c8">uart_handler</a></div><div class="ttdeci">auto uart_handler(uint64_t cause, cpu_io::TrapContext *) -&gt; uint64_t</div><div class="ttdef"><b>Definition</b> <a href="aarch64_2interrupt__main_8cpp_source.html#l00141">interrupt_main.cpp:141</a></div></div>
<div class="ttc" id="aaarch64_2timer_8cpp_html_a8febf243f0581d61474fd6b56cfdb544"><div class="ttname"><a href="aarch64_2timer_8cpp.html#a8febf243f0581d61474fd6b56cfdb544">TimerInit</a></div><div class="ttdeci">void TimerInit()</div><div class="ttdef"><b>Definition</b> <a href="aarch64_2timer_8cpp_source.html#l00032">timer.cpp:32</a></div></div>
<div class="ttc" id="aclassGic_html_a4cce758a89d33ca112a0c42d162fed99"><div class="ttname"><a href="classGic.html#a4cce758a89d33ca112a0c42d162fed99">Gic::kSPIBase</a></div><div class="ttdeci">static constexpr size_t kSPIBase</div><div class="ttdef"><b>Definition</b> <a href="gic_8h_source.html#l00028">gic.h:28</a></div></div>
<div class="ttc" id="anamespacecpu__io_html_a52b8a7263a31e6670ef4dec7922d9e72"><div class="ttname"><a href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72">cpu_io::GetCurrentCoreId</a></div><div class="ttdeci">auto GetCurrentCoreId() -&gt; size_t</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00026">cpu_io.h:26</a></div></div>
<div class="ttc" id="anamespacecpu__io_html_afe7f925ac3cb632ed212166712288451"><div class="ttname"><a href="namespacecpu__io.html#afe7f925ac3cb632ed212166712288451">cpu_io::EnableInterrupt</a></div><div class="ttdeci">void EnableInterrupt()</div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00034">cpu_io.h:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a27506b04ac03abcaede4a6a9863c1ac0_cgraph.png" border="0" usemap="#aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_cgraph" alt=""/></div>
<map name="aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_cgraph" id="aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_cgraph">
<area shape="rect" title=" " alt="" coords="5,156,104,181"/>
<area shape="rect" href="namespacecpu__io.html#afe7f925ac3cb632ed212166712288451" title=" " alt="" coords="311,5,483,31"/>
<area shape="poly" title=" " alt="" coords="61,154,96,107,121,81,151,60,186,44,223,32,296,19,297,24,224,37,188,49,153,64,124,85,100,111,66,157"/>
<area shape="rect" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72" title=" " alt="" coords="304,55,489,80"/>
<area shape="poly" title=" " alt="" coords="66,154,101,121,125,104,151,90,220,71,290,63,291,68,221,76,153,95,128,108,105,125,69,158"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="312,131,481,156"/>
<area shape="poly" title=" " alt="" coords="104,162,298,148,298,153,104,168"/>
<area shape="rect" href="aarch64_2timer_8cpp.html#a8febf243f0581d61474fd6b56cfdb544" title=" " alt="" coords="163,105,245,131"/>
<area shape="poly" title=" " alt="" coords="92,153,152,133,153,138,94,158"/>
<area shape="rect" href="arch_8cpp.html#ac73d8c3647dca189d5c572ba9c48f471" title=" " alt="" coords="159,207,249,232"/>
<area shape="poly" title=" " alt="" coords="94,179,153,200,152,205,92,184"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html#afeb27dda805c973ef825d7f26ea196c8" title=" " alt="" coords="152,256,256,281"/>
<area shape="poly" title=" " alt="" coords="72,180,108,210,153,242,162,247,159,252,151,247,105,214,68,184"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html#a2a09df74b4cb8ba4d0fe481aaa679816" title="中断处理函数" alt="" coords="153,305,255,331"/>
<area shape="poly" title=" " alt="" coords="65,180,100,233,125,264,154,292,159,296,156,300,150,296,121,268,95,236,61,183"/>
<area shape="rect" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d" title="获取当前线程的环境实例指针（供 Mock 层调用）" alt="" coords="537,23,800,63"/>
<area shape="poly" title=" " alt="" coords="483,23,524,27,523,32,483,29"/>
<area shape="poly" title=" " alt="" coords="489,57,523,54,524,59,490,62"/>
<area shape="poly" title=" " alt="" coords="244,105,334,81,335,86,245,110"/>
<area shape="poly" title=" " alt="" coords="245,121,298,128,298,133,244,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a27506b04ac03abcaede4a6a9863c1ac0_icgraph.png" border="0" usemap="#aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_icgraph" alt=""/></div>
<map name="aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_icgraph" id="aarch_8h_a27506b04ac03abcaede4a6a9863c1ac0_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,207,31"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html#ab85c3edfd2aada0e059dccf8d002924d" title="内核入口" alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="a790bd86205392967bd3fbc5533fbb144" name="a790bd86205392967bd3fbc5533fbb144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a790bd86205392967bd3fbc5533fbb144">&#9670;&#160;</a></span>InterruptInitSMP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InterruptInitSMP </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aarch64_2interrupt__main_8cpp_source.html#l00170">170</a> of file <a class="el" href="aarch64_2interrupt__main_8cpp_source.html">interrupt_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  170</span>                                         {</div>
<div class="line"><span class="lineno">  171</span>  cpu_io::VBAR_EL1::Write(<span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="aarch64_2interrupt__main_8cpp.html#a2a09df74b4cb8ba4d0fe481aaa679816">vector_table</a>));</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().SetUP();</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <a class="code hl_function" href="namespacecpu__io.html#afe7f925ac3cb632ed212166712288451">cpu_io::EnableInterrupt</a>();</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <a class="code hl_function" href="aarch64_2timer_8cpp.html#a85b082ebd75de9086c93c05ad124fc8c">TimerInitSMP</a>();</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  <a class="code hl_struct" href="structklog_1_1Info.html">klog::Info</a>(<span class="stringliteral">&quot;Hello InterruptInitSMP\n&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span>}</div>
<div class="ttc" id="aaarch64_2timer_8cpp_html_a85b082ebd75de9086c93c05ad124fc8c"><div class="ttname"><a href="aarch64_2timer_8cpp.html#a85b082ebd75de9086c93c05ad124fc8c">TimerInitSMP</a></div><div class="ttdeci">void TimerInitSMP()</div><div class="ttdef"><b>Definition</b> <a href="aarch64_2timer_8cpp_source.html#l00019">timer.cpp:19</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a790bd86205392967bd3fbc5533fbb144_cgraph.png" border="0" usemap="#aarch_8h_a790bd86205392967bd3fbc5533fbb144_cgraph" alt=""/></div>
<map name="aarch_8h_a790bd86205392967bd3fbc5533fbb144_cgraph" id="aarch_8h_a790bd86205392967bd3fbc5533fbb144_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,132,131"/>
<area shape="rect" href="namespacecpu__io.html#afe7f925ac3cb632ed212166712288451" title=" " alt="" coords="344,5,516,31"/>
<area shape="poly" title=" " alt="" coords="92,103,132,83,179,65,256,44,330,29,331,35,257,49,181,70,134,88,95,108"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="345,56,515,81"/>
<area shape="poly" title=" " alt="" coords="118,103,180,90,331,72,332,78,180,95,120,108"/>
<area shape="rect" href="aarch64_2timer_8cpp.html#a85b082ebd75de9086c93c05ad124fc8c" title=" " alt="" coords="180,105,289,131"/>
<area shape="poly" title=" " alt="" coords="132,115,166,115,166,121,132,121"/>
<area shape="rect" href="arch_8cpp.html#ac73d8c3647dca189d5c572ba9c48f471" title=" " alt="" coords="190,155,279,180"/>
<area shape="poly" title=" " alt="" coords="113,128,179,148,177,153,111,133"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html#a2a09df74b4cb8ba4d0fe481aaa679816" title="中断处理函数" alt="" coords="183,204,286,229"/>
<area shape="poly" title=" " alt="" coords="88,129,130,158,181,190,192,196,189,200,179,195,127,163,85,133"/>
<area shape="rect" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d" title="获取当前线程的环境实例指针（供 Mock 层调用）" alt="" coords="571,49,833,89"/>
<area shape="poly" title=" " alt="" coords="499,28,581,44,580,49,498,33"/>
<area shape="poly" title=" " alt="" coords="285,103,365,82,366,87,286,108"/>
<area shape="rect" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72" title=" " alt="" coords="337,105,523,131"/>
<area shape="poly" title=" " alt="" coords="290,115,324,115,324,121,290,121"/>
<area shape="poly" title=" " alt="" coords="500,103,577,89,578,94,501,108"/>
</map>
</div>

</div>
</div>
<a id="a7241001f2323bd5690c3ee10606fb8c4" name="a7241001f2323bd5690c3ee10606fb8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7241001f2323bd5690c3ee10606fb8c4">&#9670;&#160;</a></span>kernel_thread_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kernel_thread_entry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8cpp_source.html#l00044">44</a> of file <a class="el" href="arch_8cpp_source.html">arch.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span>{}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a7241001f2323bd5690c3ee10606fb8c4_icgraph.png" border="0" usemap="#aarch_8h_a7241001f2323bd5690c3ee10606fb8c4_icgraph" alt=""/></div>
<map name="aarch_8h_a7241001f2323bd5690c3ee10606fb8c4_icgraph" id="aarch_8h_a7241001f2323bd5690c3ee10606fb8c4_icgraph">
<area shape="rect" title=" " alt="" coords="443,31,595,56"/>
<area shape="rect" href="aarch64_2arch__main_8cpp.html#a68bd5f23f249b2c277d460dc2e2ee47a" title=" " alt="" coords="272,5,395,31"/>
<area shape="poly" title=" " alt="" coords="429,34,395,29,396,24,429,28"/>
<area shape="rect" href="aarch64_2arch__main_8cpp.html#a13c92ba83f807779913f45bc9ac404b0" title=" " alt="" coords="272,55,395,80"/>
<area shape="poly" title=" " alt="" coords="429,58,395,62,395,57,429,52"/>
<area shape="rect" href="structTaskControlBlock.html#a6e96afd7da4feb231b605e2b7cebfc42" title="构造函数 (内核线程)" alt="" coords="5,47,224,87"/>
<area shape="poly" title=" " alt="" coords="258,70,224,70,224,65,258,65"/>
</map>
</div>

</div>
</div>
<a id="a1a5356ccbae40313871a4877d89cc53d" name="a1a5356ccbae40313871a4877d89cc53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5356ccbae40313871a4877d89cc53d">&#9670;&#160;</a></span>switch_to()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switch_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *&#160;</td>
          <td class="paramname"><em>prev_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcpu__io_1_1CalleeSavedContext.html">cpu_io::CalleeSavedContext</a> *&#160;</td>
          <td class="paramname"><em>next_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright The SimpleKernel Contributors </dd></dl>

<p class="definition">Definition at line <a class="el" href="arch_8cpp_source.html#l00015">15</a> of file <a class="el" href="arch_8cpp_source.html">arch.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   16</span>                                                   {</div>
<div class="line"><span class="lineno">   17</span>  <span class="keyword">auto</span>* env_state =</div>
<div class="line"><span class="lineno">   18</span>      <a class="code hl_function" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d">test_env::TestEnvironmentState::GetCurrentThreadEnvironment</a>();</div>
<div class="line"><span class="lineno">   19</span>  assert(env_state &amp;&amp;</div>
<div class="line"><span class="lineno">   20</span>         <span class="stringliteral">&quot;TestEnvironmentState not set for current thread. &quot;</span></div>
<div class="line"><span class="lineno">   21</span>         <span class="stringliteral">&quot;Did you forget to call SetCurrentThreadEnvironment()?&quot;</span>);</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span>  <span class="keyword">auto</span>&amp; core_env = env_state-&gt;GetCurrentCoreEnv();</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  <span class="comment">// 从上下文指针查找对应的任务</span></div>
<div class="line"><span class="lineno">   26</span>  <span class="keyword">auto</span>* prev_task = env_state-&gt;FindTaskByContext(prev_ctx);</div>
<div class="line"><span class="lineno">   27</span>  <span class="keyword">auto</span>* next_task = env_state-&gt;FindTaskByContext(next_ctx);</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>  <span class="comment">// 获取 PerCpu 数据</span></div>
<div class="line"><span class="lineno">   30</span>  <span class="keyword">auto</span>&amp; <a class="code hl_namespace" href="namespaceper__cpu.html">per_cpu</a> = <a class="code hl_function" href="namespaceper__cpu.html#ad9745465fefcd58504031bfcfcc1c13f">per_cpu::GetCurrentCore</a>();</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  <span class="comment">// 记录切换事件到环境层</span></div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_struct" href="structtest__env_1_1CoreEnvironment_1_1SwitchEvent.html">test_env::CoreEnvironment::SwitchEvent</a> event;</div>
<div class="line"><span class="lineno">   34</span>  <span class="keyword">event</span>.<a class="code hl_variable" href="structtest__env_1_1CoreEnvironment_1_1SwitchEvent.html#ad717b7800f719fdae9bf8b5186b163fb">timestamp</a> = (<a class="code hl_namespace" href="namespaceper__cpu.html">per_cpu</a>.sched_data ? <a class="code hl_namespace" href="namespaceper__cpu.html">per_cpu</a>.sched_data-&gt;local_tick : 0);</div>
<div class="line"><span class="lineno">   35</span>  <span class="keyword">event</span>.from = prev_task;</div>
<div class="line"><span class="lineno">   36</span>  <span class="keyword">event</span>.to = next_task;</div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">event</span>.core_id = core_env.core_id;</div>
<div class="line"><span class="lineno">   38</span>  core_env.switch_history.push_back(event);</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="comment">// 更新 PerCpu 的当前线程</span></div>
<div class="line"><span class="lineno">   41</span>  <a class="code hl_namespace" href="namespaceper__cpu.html">per_cpu</a>.running_task = next_task;</div>
<div class="line"><span class="lineno">   42</span>}</div>
<div class="ttc" id="aclasstest__env_1_1TestEnvironmentState_html_a562424679984595e70361b0dad2ef96d"><div class="ttname"><a href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d">test_env::TestEnvironmentState::GetCurrentThreadEnvironment</a></div><div class="ttdeci">static auto GetCurrentThreadEnvironment() -&gt; TestEnvironmentState *</div><div class="ttdoc">获取当前线程的环境实例指针（供 Mock 层调用）</div><div class="ttdef"><b>Definition</b> <a href="test__environment__state_8cpp_source.html#l00026">test_environment_state.cpp:26</a></div></div>
<div class="ttc" id="anamespaceper__cpu_html"><div class="ttname"><a href="namespaceper__cpu.html">per_cpu</a></div><div class="ttdef"><b>Definition</b> <a href="per__cpu_8hpp_source.html#l00022">per_cpu.hpp:22</a></div></div>
<div class="ttc" id="anamespaceper__cpu_html_ad9745465fefcd58504031bfcfcc1c13f"><div class="ttname"><a href="namespaceper__cpu.html#ad9745465fefcd58504031bfcfcc1c13f">per_cpu::GetCurrentCore</a></div><div class="ttdeci">static __always_inline auto GetCurrentCore() -&gt; PerCpu &amp;</div><div class="ttdef"><b>Definition</b> <a href="per__cpu_8hpp_source.html#l00051">per_cpu.hpp:51</a></div></div>
<div class="ttc" id="astructtest__env_1_1CoreEnvironment_1_1SwitchEvent_html"><div class="ttname"><a href="structtest__env_1_1CoreEnvironment_1_1SwitchEvent.html">test_env::CoreEnvironment::SwitchEvent</a></div><div class="ttdef"><b>Definition</b> <a href="test__environment__state_8hpp_source.html#l00037">test_environment_state.hpp:37</a></div></div>
<div class="ttc" id="astructtest__env_1_1CoreEnvironment_1_1SwitchEvent_html_ad717b7800f719fdae9bf8b5186b163fb"><div class="ttname"><a href="structtest__env_1_1CoreEnvironment_1_1SwitchEvent.html#ad717b7800f719fdae9bf8b5186b163fb">test_env::CoreEnvironment::SwitchEvent::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition</b> <a href="test__environment__state_8hpp_source.html#l00039">test_environment_state.hpp:39</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a1a5356ccbae40313871a4877d89cc53d_cgraph.png" border="0" usemap="#aarch_8h_a1a5356ccbae40313871a4877d89cc53d_cgraph" alt=""/></div>
<map name="aarch_8h_a1a5356ccbae40313871a4877d89cc53d_cgraph" id="aarch_8h_a1a5356ccbae40313871a4877d89cc53d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,89,56"/>
<area shape="rect" href="namespaceper__cpu.html#ad9745465fefcd58504031bfcfcc1c13f" title=" " alt="" coords="137,5,320,31"/>
<area shape="poly" title=" " alt="" coords="89,35,124,30,125,35,90,40"/>
<area shape="rect" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d" title="获取当前线程的环境实例指针（供 Mock 层调用）" alt="" coords="601,23,864,63"/>
<area shape="poly" title=" " alt="" coords="90,41,588,41,588,46,90,46"/>
<area shape="rect" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72" title=" " alt="" coords="368,5,553,31"/>
<area shape="poly" title=" " alt="" coords="321,15,354,15,354,21,321,21"/>
<area shape="poly" title=" " alt="" coords="554,24,588,27,587,32,553,29"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a1a5356ccbae40313871a4877d89cc53d_icgraph.png" border="0" usemap="#aarch_8h_a1a5356ccbae40313871a4877d89cc53d_icgraph" alt=""/></div>
<map name="aarch_8h_a1a5356ccbae40313871a4877d89cc53d_icgraph" id="aarch_8h_a1a5356ccbae40313871a4877d89cc53d_icgraph">
<area shape="rect" title=" " alt="" coords="660,153,744,179"/>
<area shape="rect" href="classTaskManager.html#af7525954e852c09c1dd8ba50235f1d78" title="调度函数 选择下一个任务并切换上下文" alt="" coords="437,79,612,104"/>
<area shape="poly" title=" " alt="" coords="669,148,611,118,579,107,580,102,613,113,671,144"/>
<area shape="rect" href="task__scheduling__example__test_8cpp.html#ae2476f4138ea3da243c4248b722039c5" title="示例：清空切换历史" alt="" coords="490,128,559,153"/>
<area shape="poly" title=" " alt="" coords="646,161,559,148,560,143,647,155"/>
<area shape="rect" href="task__scheduling__example__test_8cpp.html#ad287521df6cc3daaa5fb96ea8afcfd38" title="示例：验证多次切换的历史记录" alt="" coords="490,177,559,203"/>
<area shape="poly" title=" " alt="" coords="647,176,560,188,559,183,646,171"/>
<area shape="rect" href="task__scheduling__example__test_8cpp.html#aff367fc7a0b493d3bba6057fce1a57eb" title="示例：验证 switch_to 记录切换历史" alt="" coords="490,227,559,252"/>
<area shape="poly" title=" " alt="" coords="670,188,613,218,560,234,559,229,611,213,668,184"/>
<area shape="rect" href="classTaskManager.html#a71763ebababa9aa90bad6a07c66edede" title="阻塞当前任务" alt="" coords="218,5,370,31"/>
<area shape="poly" title=" " alt="" coords="478,76,389,45,349,33,350,28,390,39,480,71"/>
<area shape="rect" href="classTaskManager.html#ae3444c55ab7b6ec348a56b596229fc0f" title="退出当前线程" alt="" coords="223,55,365,80"/>
<area shape="poly" title=" " alt="" coords="423,83,365,77,365,72,424,78"/>
<area shape="rect" href="classTaskManager.html#a86fe8ff01e353a0acb150c90e8081811" title="线程睡眠" alt="" coords="218,104,370,129"/>
<area shape="poly" title=" " alt="" coords="424,105,370,111,370,106,423,100"/>
<area shape="rect" href="classTaskManager.html#aa1041f9ed06a9d0b6b738621c30e1921" title="更新系统 tick" alt="" coords="199,153,389,179"/>
<area shape="poly" title=" " alt="" coords="459,111,438,118,415,130,390,143,352,156,350,151,388,138,412,126,436,113,457,106"/>
<area shape="rect" href="classTaskManager.html#aadc206ac53400212078270833533f247" title="等待子进程退出" alt="" coords="5,5,151,31"/>
<area shape="poly" title=" " alt="" coords="204,21,151,21,151,15,204,15"/>
</map>
</div>

</div>
</div>
<a id="a8febf243f0581d61474fd6b56cfdb544" name="a8febf243f0581d61474fd6b56cfdb544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8febf243f0581d61474fd6b56cfdb544">&#9670;&#160;</a></span>TimerInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aarch64_2timer_8cpp_source.html#l00032">32</a> of file <a class="el" href="aarch64_2timer_8cpp_source.html">timer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>                 {</div>
<div class="line"><span class="lineno">   33</span>  <span class="comment">// 计算 interval</span></div>
<div class="line"><span class="lineno">   34</span>  interval = <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;BasicInfo&gt;::GetInstance</a>().interval / SIMPLEKERNEL_TICK;</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  <span class="comment">// 获取定时器中断号</span></div>
<div class="line"><span class="lineno">   37</span>  timer_intid = <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;KernelFdt&gt;::GetInstance</a>()</div>
<div class="line"><span class="lineno">   38</span>                    .GetAarch64Intid(<span class="stringliteral">&quot;arm,armv8-timer&quot;</span>)</div>
<div class="line"><span class="lineno">   39</span>                    .value() +</div>
<div class="line"><span class="lineno">   40</span>                <a class="code hl_variable" href="classGic.html#a56c9c92897f2819cbcf33cda56f13ebc">Gic::kPPIBase</a>;</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().RegisterInterruptFunc(</div>
<div class="line"><span class="lineno">   43</span>      timer_intid, [](uint64_t, <a class="code hl_struct" href="structcpu__io_1_1TrapContext.html">cpu_io::TrapContext</a>*) -&gt; uint64_t {</div>
<div class="line"><span class="lineno">   44</span>        cpu_io::CNTV_TVAL_EL0::Write(interval);</div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;TaskManager&gt;::GetInstance</a>().TickUpdate();</div>
<div class="line"><span class="lineno">   46</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   47</span>      });</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().PPI(timer_intid,</div>
<div class="line"><span class="lineno">   50</span>                                          <a class="code hl_function" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72">cpu_io::GetCurrentCoreId</a>());</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  cpu_io::CNTV_CTL_EL0::ENABLE::Clear();</div>
<div class="line"><span class="lineno">   53</span>  cpu_io::CNTV_CTL_EL0::IMASK::Set();</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  cpu_io::CNTV_TVAL_EL0::Write(interval);</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  cpu_io::CNTV_CTL_EL0::ENABLE::Set();</div>
<div class="line"><span class="lineno">   58</span>  cpu_io::CNTV_CTL_EL0::IMASK::Clear();</div>
<div class="line"><span class="lineno">   59</span>}</div>
<div class="ttc" id="aclassGic_html_a56c9c92897f2819cbcf33cda56f13ebc"><div class="ttname"><a href="classGic.html#a56c9c92897f2819cbcf33cda56f13ebc">Gic::kPPIBase</a></div><div class="ttdeci">static constexpr size_t kPPIBase</div><div class="ttdef"><b>Definition</b> <a href="gic_8h_source.html#l00026">gic.h:26</a></div></div>
<div class="ttc" id="astructcpu__io_1_1TrapContext_html"><div class="ttname"><a href="structcpu__io_1_1TrapContext.html">cpu_io::TrapContext</a></div><div class="ttdef"><b>Definition</b> <a href="cpu__io_8h_source.html#l00181">cpu_io.h:181</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a8febf243f0581d61474fd6b56cfdb544_cgraph.png" border="0" usemap="#aarch_8h_a8febf243f0581d61474fd6b56cfdb544_cgraph" alt=""/></div>
<map name="aarch_8h_a8febf243f0581d61474fd6b56cfdb544_cgraph" id="aarch_8h_a8febf243f0581d61474fd6b56cfdb544_cgraph">
<area shape="rect" title=" " alt="" coords="5,38,87,63"/>
<area shape="rect" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72" title=" " alt="" coords="135,13,320,38"/>
<area shape="poly" title=" " alt="" coords="87,42,123,37,123,43,87,48"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="143,62,312,87"/>
<area shape="poly" title=" " alt="" coords="87,53,129,59,129,64,87,59"/>
<area shape="rect" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d" title="获取当前线程的环境实例指针（供 Mock 层调用）" alt="" coords="368,5,631,45"/>
<area shape="poly" title=" " alt="" coords="320,23,354,23,354,28,320,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a8febf243f0581d61474fd6b56cfdb544_icgraph.png" border="0" usemap="#aarch_8h_a8febf243f0581d61474fd6b56cfdb544_icgraph" alt=""/></div>
<map name="aarch_8h_a8febf243f0581d61474fd6b56cfdb544_icgraph" id="aarch_8h_a8febf243f0581d61474fd6b56cfdb544_icgraph">
<area shape="rect" title=" " alt="" coords="255,5,336,31"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html#a660e4785391d83bb3aa43f15ae53a530" title=" " alt="" coords="108,5,207,31"/>
<area shape="poly" title=" " alt="" coords="241,21,207,21,207,15,241,15"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html#ab85c3edfd2aada0e059dccf8d002924d" title="内核入口" alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="a85b082ebd75de9086c93c05ad124fc8c" name="a85b082ebd75de9086c93c05ad124fc8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b082ebd75de9086c93c05ad124fc8c">&#9670;&#160;</a></span>TimerInitSMP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerInitSMP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright The SimpleKernel Contributors </dd></dl>

<p class="definition">Definition at line <a class="el" href="aarch64_2timer_8cpp_source.html#l00019">19</a> of file <a class="el" href="aarch64_2timer_8cpp_source.html">timer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   19</span>                    {</div>
<div class="line"><span class="lineno">   20</span>  <a class="code hl_function" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd">Singleton&lt;Interrupt&gt;::GetInstance</a>().PPI(timer_intid,</div>
<div class="line"><span class="lineno">   21</span>                                          <a class="code hl_function" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72">cpu_io::GetCurrentCoreId</a>());</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span>  cpu_io::CNTV_CTL_EL0::ENABLE::Clear();</div>
<div class="line"><span class="lineno">   24</span>  cpu_io::CNTV_CTL_EL0::IMASK::Set();</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span>  cpu_io::CNTV_TVAL_EL0::Write(interval);</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  cpu_io::CNTV_CTL_EL0::ENABLE::Set();</div>
<div class="line"><span class="lineno">   29</span>  cpu_io::CNTV_CTL_EL0::IMASK::Clear();</div>
<div class="line"><span class="lineno">   30</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a85b082ebd75de9086c93c05ad124fc8c_cgraph.png" border="0" usemap="#aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_cgraph" alt=""/></div>
<map name="aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_cgraph" id="aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_cgraph">
<area shape="rect" title=" " alt="" coords="5,38,115,63"/>
<area shape="rect" href="namespacecpu__io.html#a52b8a7263a31e6670ef4dec7922d9e72" title=" " alt="" coords="163,13,348,38"/>
<area shape="poly" title=" " alt="" coords="115,41,149,36,150,42,115,46"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="171,62,340,87"/>
<area shape="poly" title=" " alt="" coords="115,55,157,60,157,65,115,60"/>
<area shape="rect" href="classtest__env_1_1TestEnvironmentState.html#a562424679984595e70361b0dad2ef96d" title="获取当前线程的环境实例指针（供 Mock 层调用）" alt="" coords="396,5,659,45"/>
<area shape="poly" title=" " alt="" coords="348,23,382,23,382,28,348,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a85b082ebd75de9086c93c05ad124fc8c_icgraph.png" border="0" usemap="#aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_icgraph" alt=""/></div>
<map name="aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_icgraph" id="aarch_8h_a85b082ebd75de9086c93c05ad124fc8c_icgraph">
<area shape="rect" title=" " alt="" coords="180,5,289,31"/>
<area shape="rect" href="aarch64_2interrupt__main_8cpp.html#ac31c690eba7c84c9327f9f813d4b3fea" title=" " alt="" coords="5,5,132,31"/>
<area shape="poly" title=" " alt="" coords="166,21,132,21,132,15,166,15"/>
</map>
</div>

</div>
</div>
<a id="ac73d8c3647dca189d5c572ba9c48f471" name="ac73d8c3647dca189d5c572ba9c48f471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac73d8c3647dca189d5c572ba9c48f471">&#9670;&#160;</a></span>trap_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trap_entry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8cpp_source.html#l00046">46</a> of file <a class="el" href="arch_8cpp_source.html">arch.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_ac73d8c3647dca189d5c572ba9c48f471_icgraph.png" border="0" usemap="#aarch_8h_ac73d8c3647dca189d5c572ba9c48f471_icgraph" alt=""/></div>
<map name="aarch_8h_ac73d8c3647dca189d5c572ba9c48f471_icgraph" id="aarch_8h_ac73d8c3647dca189d5c572ba9c48f471_icgraph">
<area shape="rect" title=" " alt="" coords="180,31,269,56"/>
<area shape="rect" href="riscv64_2interrupt__main_8cpp.html#a660e4785391d83bb3aa43f15ae53a530" title=" " alt="" coords="19,5,118,31"/>
<area shape="poly" title=" " alt="" coords="166,37,118,29,119,23,167,31"/>
<area shape="rect" href="riscv64_2interrupt__main_8cpp.html#ac31c690eba7c84c9327f9f813d4b3fea" title=" " alt="" coords="5,55,132,80"/>
<area shape="poly" title=" " alt="" coords="167,55,133,60,132,55,166,50"/>
</map>
</div>

</div>
</div>
<a id="acdf04695210228502c6042c9f530faf1" name="acdf04695210228502c6042c9f530faf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdf04695210228502c6042c9f530faf1">&#9670;&#160;</a></span>trap_return()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trap_return </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8cpp_source.html#l00045">45</a> of file <a class="el" href="arch_8cpp_source.html">arch.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>{}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_acdf04695210228502c6042c9f530faf1_icgraph.png" border="0" usemap="#aarch_8h_acdf04695210228502c6042c9f530faf1_icgraph" alt=""/></div>
<map name="aarch_8h_acdf04695210228502c6042c9f530faf1_icgraph" id="aarch_8h_acdf04695210228502c6042c9f530faf1_icgraph">
<area shape="rect" title=" " alt="" coords="176,5,271,31"/>
<area shape="rect" href="aarch64_2arch__main_8cpp.html#a68bd5f23f249b2c277d460dc2e2ee47a" title=" " alt="" coords="5,5,128,31"/>
<area shape="poly" title=" " alt="" coords="162,21,128,21,128,15,162,15"/>
</map>
</div>

</div>
</div>
<a id="a94c31dc3a1de17229bc6863fff8eddd7" name="a94c31dc3a1de17229bc6863fff8eddd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c31dc3a1de17229bc6863fff8eddd7">&#9670;&#160;</a></span>WakeUpOtherCores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WakeUpOtherCores </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>唤醒其余 core </p>

<p class="definition">Definition at line <a class="el" href="aarch64_2arch__main_8cpp_source.html#l00070">70</a> of file <a class="el" href="aarch64_2arch__main_8cpp_source.html">arch_main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   70</span>                        {</div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; Singleton&lt;BasicInfo&gt;::GetInstance().core_count; i++) {</div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">auto</span> ret = cpu_io::psci::CpuOn(i, <span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code hl_function" href="basic__info_8hpp.html#a698036b5e342c2164fb7fd7249d0e801">_boot</a>), 0);</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> ((ret != cpu_io::psci::SUCCESS) &amp;&amp; (ret != cpu_io::psci::ALREADY_ON)) {</div>
<div class="line"><span class="lineno">   74</span>      <a class="code hl_struct" href="structklog_1_1Warn.html">klog::Warn</a>(<span class="stringliteral">&quot;hart %d start failed: %d\n&quot;</span>, i, ret);</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span>  }</div>
<div class="line"><span class="lineno">   77</span>}</div>
<div class="ttc" id="abasic__info_8hpp_html_a698036b5e342c2164fb7fd7249d0e801"><div class="ttname"><a href="basic__info_8hpp.html#a698036b5e342c2164fb7fd7249d0e801">_boot</a></div><div class="ttdeci">void _boot()</div><div class="ttdoc">内核入口，在 boot.S 中定义</div></div>
<div class="ttc" id="astructklog_1_1Warn_html"><div class="ttname"><a href="structklog_1_1Warn.html">klog::Warn</a></div><div class="ttdef"><b>Definition</b> <a href="kernel__log_8hpp_source.html#l00178">kernel_log.hpp:178</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a94c31dc3a1de17229bc6863fff8eddd7_cgraph.png" border="0" usemap="#aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_cgraph" alt=""/></div>
<map name="aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_cgraph" id="aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,153,56"/>
<area shape="rect" href="basic__info_8hpp.html#a698036b5e342c2164fb7fd7249d0e801" title="内核入口，在 boot.S 中定义" alt="" coords="257,5,315,31"/>
<area shape="poly" title=" " alt="" coords="153,32,242,21,243,26,154,37"/>
<area shape="rect" href="classSingleton.html#a68856b49e098eadba37b60366db33ebd" title=" " alt="" coords="201,55,371,80"/>
<area shape="poly" title=" " alt="" coords="154,49,188,53,187,59,153,55"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch_8h_a94c31dc3a1de17229bc6863fff8eddd7_icgraph.png" border="0" usemap="#aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_icgraph" alt=""/></div>
<map name="aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_icgraph" id="aarch_8h_a94c31dc3a1de17229bc6863fff8eddd7_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,256,31"/>
<area shape="rect" href="tests_2system__test_2main_8cpp.html#ab85c3edfd2aada0e059dccf8d002924d" title="内核入口" alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa6bf08e475b70fd9c9f5c7c5dbb04fac" name="aa6bf08e475b70fd9c9f5c7c5dbb04fac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6bf08e475b70fd9c9f5c7c5dbb04fac">&#9670;&#160;</a></span>kMaxFrameCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t kMaxFrameCount = 128</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>最多回溯 128 层调用栈 </p>

<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00071">71</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_70d5e250c66d001b18da37689179cade.html">arch</a></li><li class="navelem"><a class="el" href="arch_8h.html">arch.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
