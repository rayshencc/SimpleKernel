<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SimpleKernel: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SimpleKernel<span id="projectnumber">&#160;1.17.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__2root_2README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://codecov.io/gh/Simple-XX/SimpleKernel"><img src="https://codecov.io/gh/Simple-XX/SimpleKernel/graph/badge.svg?token=J7NKK3SBNJ" alt="codecov" style="pointer-events: none;" class="inline"/></a> <img src="https://github.com/Simple-XX/SimpleKernel/actions/workflows/workflow.yml/badge.svg" alt="workflow" style="pointer-events: none;" class="inline"/> <img src="https://img.shields.io/github/commit-activity/t/Simple-XX/SimpleKernel" alt="commit-activity" class="inline"/> <img src="https://img.shields.io/github/last-commit/Simple-XX/SimpleKernel/main" alt="last-commit-interrupt" class="inline"/> <img src="https://img.shields.io/github/license/mashape/apistatus.svg" alt="MIT License" style="pointer-events: none;" class="inline"/> <a href="https://github.com/996icu/996.ICU/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-Anti%20996-blue.svg" alt="LICENSE" style="pointer-events: none;" class="inline"/></a> <a href="https://996.icu"><img src="https://img.shields.io/badge/link-996.icu-red.svg" alt="996.icu" style="pointer-events: none;" class="inline"/></a></p>
<p><a class="el" href="md__2root_2README__ENG.html">English</a> | <a class="el" href="md__2root_2README.html">中文</a></p>
<h1><a class="anchor" id="autotoc_md291"></a>
SimpleKernel</h1>
<p><b>面向 AI 的操作系统学习项目 | Interface-Driven OS Kernel for AI-Assisted Learning</b></p>
<blockquote class="doxtable">
<p>&zwj;🤖 **设计理念**：定义清晰的内核接口，由 AI 完成实现——学习操作系统的新范式 </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md292"></a>
📖 目录</h2>
<ul>
<li>✨ 项目简介</li>
<li>🤖 面向 AI 的设计理念</li>
<li>🏛️ 接口体系总览</li>
<li>🏗️ 支持架构</li>
<li>🚀 快速开始</li>
<li>📂 项目结构</li>
<li>🎯 学习路线</li>
<li>📦 第三方依赖</li>
<li>📝 开发指南</li>
<li>🤝 贡献指南</li>
<li>📄 许可证</li>
</ul>
<h2><a class="anchor" id="autotoc_md293"></a>
✨ 项目简介</h2>
<p>SimpleKernel 是一个**面向 AI 辅助学习的现代化操作系统内核项目**。采用 C++23 编写，支持 x86_64、RISC-V 64 和 AArch64 三种架构。</p>
<p>与传统 OS 教学项目不同，SimpleKernel 采用**接口驱动（Interface-Driven）** 的设计：</p>
<ul>
<li>**项目主体是接口定义**——完整的头文件（<code>.h/.hpp</code>）包含类声明、纯虚接口、类型定义、Doxygen 文档</li>
<li>**实现由 AI 完成**——你只需要理解接口契约，让 AI 根据接口文档生成实现代码</li>
<li>**参考实现可供对照**——项目提供完整的参考实现，用于验证 AI 生成代码的正确性</li>
</ul>
<h3><a class="anchor" id="autotoc_md294"></a>
🌟 核心亮点</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">特性   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">🤖 <b>AI-First 设计</b>   </td><td class="markdownTableBodyNone">接口文档即 prompt，AI 可直接根据头文件生成完整实现    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">📐 <b>接口与实现分离</b>   </td><td class="markdownTableBodyNone">头文件只有声明和契约，实现在独立的 <code>.cpp</code> 中    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">🌐 <b>三架构支持</b>   </td><td class="markdownTableBodyNone">x86_64、RISC-V 64、AArch64，同一套接口适配不同硬件    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">🧪 <b>测试驱动验证</b>   </td><td class="markdownTableBodyNone">GoogleTest 测试套件验证 AI 生成的实现是否符合接口契约    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">📖 <b>完整 Doxygen 文档</b>   </td><td class="markdownTableBodyNone">每个接口都有职责描述、前置条件、后置条件、使用示例    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">🏗️ <b>工程化基础设施</b>   </td><td class="markdownTableBodyNone">CMake 构建、Docker 环境、CI/CD、clang-format/clang-tidy   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md295"></a>
🤖 面向 AI 的设计理念</h2>
<h3><a class="anchor" id="autotoc_md296"></a>
为什么要"面向 AI"？</h3>
<p>传统 OS 教学项目的学习路径：**读代码 → 理解原理 → 模仿修改**。这种方式存在几个问题：</p>
<ol type="1">
<li>内核代码量大，初学者容易迷失在实现细节中</li>
<li>各模块耦合紧密，难以独立理解单个子系统</li>
<li>从零实现一个模块的门槛很高，反馈周期长</li>
</ol>
<p>SimpleKernel 提出一种新范式：**读接口 → 理解契约 → AI 实现 → 测试验证**</p>
<div class="fragment"><div class="line">┌─────────────────────────────────────────────────────────┐</div>
<div class="line">│                    SimpleKernel 学习流程                   │</div>
<div class="line">│                                                         │</div>
<div class="line">│   ┌──────────┐    ┌──────────┐    ┌──────────┐         │</div>
<div class="line">│   │ 📐 接口   │───▶│ 🤖 AI    │───▶│ 🧪 测试  │         │</div>
<div class="line">│   │ 头文件    │    │ 生成实现  │    │ 验证正确性│         │</div>
<div class="line">│   │ + Doxygen │    │ (.cpp)   │    │ GoogleTest│         │</div>
<div class="line">│   └──────────┘    └──────────┘    └──────────┘         │</div>
<div class="line">│        │                               │                │</div>
<div class="line">│        │         ┌──────────┐          │                │</div>
<div class="line">│        └────────▶│ 📚 参考   │◀─────────┘                │</div>
<div class="line">│                  │ 实现对照  │                           │</div>
<div class="line">│                  └──────────┘                           │</div>
<div class="line">└─────────────────────────────────────────────────────────┘</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md297"></a>
核心工作流</h3>
<h4><a class="anchor" id="autotoc_md298"></a>
1️⃣ 阅读接口，理解契约</h4>
<p>每个模块的头文件都包含完整的接口文档：</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConsoleDriver {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~ConsoleDriver() = <span class="keywordflow">default</span>;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> PutChar(uint8_t c) <span class="keyword">const</span> = 0;</div>
<div class="line">  [[nodiscard]] <span class="keyword">virtual</span> <span class="keyword">auto</span> GetChar() const -&gt; uint8_t = 0;</div>
<div class="line">  [[nodiscard]] virtual auto TryGetChar() const -&gt; uint8_t = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md299"></a>
2️⃣ 让 AI 实现</h4>
<p>将头文件作为上下文提供给 AI（如 GitHub Copilot、ChatGPT、Claude 等），要求其生成 <code>.cpp</code> 实现。接口的 Doxygen 注释就是最好的 prompt。</p>
<h4><a class="anchor" id="autotoc_md300"></a>
3️⃣ 测试验证</h4>
<p>运行项目自带的测试套件，验证 AI 生成的实现是否符合接口契约：</p>
<div class="fragment"><div class="line">cmake --preset build_riscv64</div>
<div class="line">cd build_riscv64 &amp;&amp; make unit-test</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md301"></a>
4️⃣ 对照参考实现</h4>
<p>如果测试不通过，可以参考项目提供的参考实现进行对照和学习。</p>
<h3><a class="anchor" id="autotoc_md302"></a>
与 AI 工具的结合方式</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">场景   </th><th class="markdownTableHeadNone">使用方式    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GitHub Copilot</b>   </td><td class="markdownTableBodyNone">打开头文件，在对应的 <code>.cpp</code> 中让 Copilot 自动补全实现    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>ChatGPT / Claude</b>   </td><td class="markdownTableBodyNone">将头文件内容粘贴为上下文，要求生成完整的 <code>.cpp</code> 实现    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Copilot Chat / Cursor</b>   </td><td class="markdownTableBodyNone">在 IDE 中选中接口，要求 AI 解释契约含义或生成实现    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>自主学习</b>   </td><td class="markdownTableBodyNone">先独立思考实现思路，再让 AI 生成，对比差异   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md303"></a>
🏛️ 接口体系总览</h2>
<p>SimpleKernel 的接口按功能分为以下层次：</p>
<div class="fragment"><div class="line">┌──────────────────────────────────────────┐</div>
<div class="line">│              应用/系统调用层               │</div>
<div class="line">│         syscall.h · SyscallInit          │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│               任务管理层                  │</div>
<div class="line">│  TaskManager · SchedulerBase · Mutex     │</div>
<div class="line">│  CfsScheduler · FifoScheduler · RR ...   │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│               内存管理层                  │</div>
<div class="line">│  VirtualMemory · PhysicalMemory          │</div>
<div class="line">│  MapPage · UnmapPage · AllocFrame        │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│               中断/异常层                 │</div>
<div class="line">│  InterruptBase · RegisterInterruptFunc   │</div>
<div class="line">│  TimerInit · InterruptInit               │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│               驱动层                      │</div>
<div class="line">│  ConsoleDriver · Ns16550a · Pl011        │</div>
<div class="line">│  Gic · Plic · Apic · Timer drivers       │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│             架构抽象层 (arch.h)            │</div>
<div class="line">│  ArchInit · InterruptInit · TimerInit    │</div>
<div class="line">│  EarlyConsole（全局构造阶段自动设置）      │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│            运行时支持库                    │</div>
<div class="line">│  libc (sk_cstdio, sk_cstring, ...)       │</div>
<div class="line">│  libcxx (sk_vector, __cxa_*, ...)        │</div>
<div class="line">├──────────────────────────────────────────┤</div>
<div class="line">│            硬件 / QEMU                    │</div>
<div class="line">│  x86_64 · RISC-V 64 · AArch64           │</div>
<div class="line">└──────────────────────────────────────────┘</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md304"></a>
关键接口文件</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadNone">职责   </th><th class="markdownTableHeadNone">实现文件    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="arch_8h.html">src/arch/arch.h</a></code>   </td><td class="markdownTableBodyNone">架构无关的统一入口   </td><td class="markdownTableBodyNone">各 <code>src/arch/{arch}/</code> 目录    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="interrupt__base_8h.html">src/include/interrupt_base.h</a></code>   </td><td class="markdownTableBodyNone">中断子系统抽象基类   </td><td class="markdownTableBodyNone"><code>src/arch/{arch}/interrupt.cpp</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>src/driver/include/console_driver.h</code>   </td><td class="markdownTableBodyNone">控制台驱动抽象   </td><td class="markdownTableBodyNone"><code><a class="el" href="ns16550a_8cpp.html">ns16550a.cpp</a></code> / <code><a class="el" href="pl011_8cpp.html">pl011.cpp</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="virtual__memory_8hpp.html">src/include/virtual_memory.hpp</a></code>   </td><td class="markdownTableBodyNone">虚拟内存管理接口   </td><td class="markdownTableBodyNone"><code>src/virtual_memory.cpp</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="kernel__fdt_8hpp.html">src/include/kernel_fdt.hpp</a></code>   </td><td class="markdownTableBodyNone">设备树解析接口   </td><td class="markdownTableBodyNone"><code>src/kernel_fdt.cpp</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="kernel__elf_8hpp.html">src/include/kernel_elf.hpp</a></code>   </td><td class="markdownTableBodyNone">ELF 解析接口   </td><td class="markdownTableBodyNone"><code>src/kernel_elf.cpp</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="scheduler__base_8hpp.html">src/task/include/scheduler_base.hpp</a></code>   </td><td class="markdownTableBodyNone">调度器抽象基类   </td><td class="markdownTableBodyNone"><code>cfs_scheduler.cpp</code> 等    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="spinlock_8hpp.html">src/include/spinlock.hpp</a></code>   </td><td class="markdownTableBodyNone">自旋锁接口   </td><td class="markdownTableBodyNone">header-only（性能要求）    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="mutex_8hpp.html">src/include/mutex.hpp</a></code>   </td><td class="markdownTableBodyNone">互斥锁接口   </td><td class="markdownTableBodyNone"><code>src/task/mutex.cpp</code>   </td></tr>
</table>
<blockquote class="doxtable">
<p>&zwj;📋 完整接口重构计划见 <a class="el" href="md_TODO__interface__refactor.html">doc/TODO_interface_refactor.md</a> </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md305"></a>
🏗️ 支持架构</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">架构   </th><th class="markdownTableHeadCenter">引导链   </th><th class="markdownTableHeadCenter">串口   </th><th class="markdownTableHeadCenter">中断控制器   </th><th class="markdownTableHeadCenter">时钟    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>x86_64</b>   </td><td class="markdownTableBodyCenter">U-Boot   </td><td class="markdownTableBodyCenter">COM1   </td><td class="markdownTableBodyCenter">8259A PIC   </td><td class="markdownTableBodyCenter">8253/8254    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>RISC-V 64</b>   </td><td class="markdownTableBodyCenter">U-Boot + OpenSBI   </td><td class="markdownTableBodyCenter">SBI Call   </td><td class="markdownTableBodyCenter">Direct 模式   </td><td class="markdownTableBodyCenter">SBI Timer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>AArch64</b>   </td><td class="markdownTableBodyCenter">U-Boot + ATF + OP-TEE   </td><td class="markdownTableBodyCenter">PL011   </td><td class="markdownTableBodyCenter">GICv3   </td><td class="markdownTableBodyCenter">Generic Timer   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md306"></a>
🚀 快速开始</h2>
<h3><a class="anchor" id="autotoc_md307"></a>
📋 系统要求</h3>
<ul>
<li><b>操作系统</b>: Linux (推荐 Ubuntu 24.04) 或 macOS</li>
<li><b>容器引擎</b>: Docker 20.10+</li>
<li><b>工具链</b>: 已包含在 Docker 镜像中（GCC 交叉编译器、CMake、QEMU 等）</li>
<li><b>AI 工具（推荐）</b>: GitHub Copilot / ChatGPT / Claude</li>
</ul>
<h3><a class="anchor" id="autotoc_md308"></a>
🛠️ 环境搭建</h3>
<p><b>方式一：使用 Docker（推荐）</b></p>
<div class="fragment"><div class="line"># 1. 克隆项目</div>
<div class="line">git clone https://github.com/simple-xx/SimpleKernel.git</div>
<div class="line">cd SimpleKernel</div>
<div class="line">git submodule update --init --recursive</div>
<div class="line"> </div>
<div class="line"># 2. 启动开发环境</div>
<div class="line">docker pull ptrnull233/simple_kernel:latest</div>
<div class="line">docker run --name SimpleKernel-dev -itd -p 233:22 \</div>
<div class="line">  -v $(pwd):/root/SimpleKernel ptrnull233/simple_kernel:latest</div>
<div class="line"> </div>
<div class="line"># 3. 进入开发容器</div>
<div class="line">docker exec -it SimpleKernel-dev /bin/zsh</div>
</div><!-- fragment --><p><b>方式二：本地环境</b></p>
<p>参考 <a class="el" href="md_0___xE5_xB7_xA5_xE5_x85_xB7_xE9_x93_xBE.html">工具链文档</a> 配置本地开发环境。</p>
<h3><a class="anchor" id="autotoc_md309"></a>
⚡ 编译与运行</h3>
<div class="fragment"><div class="line">cd SimpleKernel</div>
<div class="line"> </div>
<div class="line"># 选择目标架构编译（以 RISC-V 64 为例）</div>
<div class="line">cmake --preset build_riscv64</div>
<div class="line">cd build_riscv64</div>
<div class="line"> </div>
<div class="line"># 编译内核</div>
<div class="line">make SimpleKernel</div>
<div class="line"> </div>
<div class="line"># 在 QEMU 模拟器中运行</div>
<div class="line">make run</div>
<div class="line"> </div>
<div class="line"># 运行单元测试（验证你的实现）</div>
<div class="line">make unit-test</div>
</div><!-- fragment --><p><b>支持的架构预设：</b></p><ul>
<li><code>build_riscv64</code> - RISC-V 64 位架构</li>
<li><code>build_aarch64</code> - ARM 64 位架构</li>
<li><code>build_x86_64</code> - x86 64 位架构</li>
</ul>
<h3><a class="anchor" id="autotoc_md310"></a>
🎯 AI 辅助开发工作流</h3>
<div class="fragment"><div class="line"># 1. 在 VS Code 中打开项目（推荐安装 GitHub Copilot 扩展）</div>
<div class="line">code ./SimpleKernel</div>
<div class="line"> </div>
<div class="line"># 2. 阅读头文件中的接口定义（例如 src/include/virtual_memory.hpp）</div>
<div class="line"> </div>
<div class="line"># 3. 创建/编辑对应的 .cpp 文件，让 AI 根据接口生成实现</div>
<div class="line"> </div>
<div class="line"># 4. 编译验证</div>
<div class="line">cd build_riscv64 &amp;&amp; make SimpleKernel</div>
<div class="line"> </div>
<div class="line"># 5. 运行测试</div>
<div class="line">make unit-test</div>
<div class="line"> </div>
<div class="line"># 6. 在 QEMU 中运行，观察行为</div>
<div class="line">make run</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md311"></a>
📂 项目结构</h2>
<div class="fragment"><div class="line">SimpleKernel/</div>
<div class="line">├── src/                        # 内核源码</div>
<div class="line">│   ├── include/                # 📐 公共接口头文件（项目核心）</div>
<div class="line">│   │   ├── virtual_memory.hpp  #   虚拟内存管理接口</div>
<div class="line">│   │   ├── kernel_fdt.hpp      #   设备树解析接口</div>
<div class="line">│   │   ├── kernel_elf.hpp      #   ELF 解析接口</div>
<div class="line">│   │   ├── spinlock.hpp        #   自旋锁接口</div>
<div class="line">│   │   ├── mutex.hpp           #   互斥锁接口</div>
<div class="line">│   │   └── ...</div>
<div class="line">│   ├── arch/                   # 架构相关代码</div>
<div class="line">│   │   ├── arch.h              # 📐 架构无关统一接口</div>
<div class="line">│   │   ├── aarch64/            #   AArch64 实现</div>
<div class="line">│   │   ├── riscv64/            #   RISC-V 64 实现</div>
<div class="line">│   │   └── x86_64/             #   x86_64 实现</div>
<div class="line">│   ├── driver/                 # 设备驱动</div>
<div class="line">│   │   ├── include/            # 📐 驱动接口（ConsoleDriver 等）</div>
<div class="line">│   │   ├── ns16550a/           #   NS16550A 串口驱动实现</div>
<div class="line">│   │   ├── pl011/              #   PL011 串口驱动实现</div>
<div class="line">│   │   └── ...</div>
<div class="line">│   ├── task/                   # 任务管理</div>
<div class="line">│   │   ├── include/            # 📐 调度器接口（SchedulerBase 等）</div>
<div class="line">│   │   └── ...                 #   调度器实现</div>
<div class="line">│   ├── libc/                   # 内核 C 标准库</div>
<div class="line">│   └── libcxx/                 # 内核 C++ 运行时</div>
<div class="line">├── tests/                      # 🧪 测试套件</div>
<div class="line">│   ├── unit_test/              #   单元测试</div>
<div class="line">│   ├── integration_test/       #   集成测试</div>
<div class="line">│   └── system_test/            #   系统测试（QEMU 运行）</div>
<div class="line">├── doc/                        # 📚 文档</div>
<div class="line">│   ├── TODO_interface_refactor.md  # 接口重构计划</div>
<div class="line">│   └── ...</div>
<div class="line">├── cmake/                      # CMake 构建配置</div>
<div class="line">├── 3rd/                        # 第三方依赖（Git Submodule）</div>
<div class="line">└── tools/                      # 构建工具和模板</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;📐 标记的目录/文件是**接口定义**——这是你需要重点阅读的内容。 </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md312"></a>
🎯 学习路线</h2>
<p>建议按以下顺序学习和实现各模块：</p>
<h3><a class="anchor" id="autotoc_md313"></a>
阶段 1：基础设施（Boot）</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">模块   </th><th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadCenter">难度   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Early Console   </td><td class="markdownTableBodyNone"><code><a class="el" href="arch_8h.html">src/arch/arch.h</a></code> 注释   </td><td class="markdownTableBodyCenter">⭐   </td><td class="markdownTableBodyNone">最早期的输出，理解全局构造    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">串口驱动   </td><td class="markdownTableBodyNone"><code>console_driver.h</code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">实现 <code>PutChar</code>/<code>GetChar</code>，理解 MMIO    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">设备树解析   </td><td class="markdownTableBodyNone"><code><a class="el" href="kernel__fdt_8hpp.html">kernel_fdt.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">解析硬件信息，理解 FDT 格式    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ELF 解析   </td><td class="markdownTableBodyNone"><code><a class="el" href="kernel__elf_8hpp.html">kernel_elf.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">符号表解析，用于栈回溯   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md314"></a>
阶段 2：中断系统（Interrupt）</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">模块   </th><th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadCenter">难度   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">中断基类   </td><td class="markdownTableBodyNone"><code><a class="el" href="interrupt__base_8h.html">interrupt_base.h</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">理解中断处理的统一抽象    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">中断控制器   </td><td class="markdownTableBodyNone">各架构驱动头文件   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">GIC/PLIC/PIC 硬件编程    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">时钟中断   </td><td class="markdownTableBodyNone"><code><a class="el" href="arch_8h.html">arch.h</a> → TimerInit</code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">定时器配置，tick 驱动   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md315"></a>
阶段 3：内存管理（Memory）</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">模块   </th><th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadCenter">难度   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">虚拟内存   </td><td class="markdownTableBodyNone"><code><a class="el" href="virtual__memory_8hpp.html">virtual_memory.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">页表管理、地址映射    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">物理内存   </td><td class="markdownTableBodyNone">相关接口   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">帧分配器、伙伴系统   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md316"></a>
阶段 4：任务管理（Thread/Task）</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">模块   </th><th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadCenter">难度   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">自旋锁   </td><td class="markdownTableBodyNone"><code><a class="el" href="spinlock_8hpp.html">spinlock.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐   </td><td class="markdownTableBodyNone">原子操作，多核同步    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">互斥锁   </td><td class="markdownTableBodyNone"><code><a class="el" href="mutex_8hpp.html">mutex.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">基于任务阻塞的锁    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">调度器   </td><td class="markdownTableBodyNone"><code><a class="el" href="scheduler__base_8hpp.html">scheduler_base.hpp</a></code>   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">CFS/FIFO/RR 调度算法   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md317"></a>
阶段 5：系统调用（Syscall）</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">模块   </th><th class="markdownTableHeadNone">接口文件   </th><th class="markdownTableHeadCenter">难度   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">系统调用   </td><td class="markdownTableBodyNone"><code><a class="el" href="arch_8h.html">arch.h</a> → SyscallInit</code>   </td><td class="markdownTableBodyCenter">⭐⭐⭐   </td><td class="markdownTableBodyNone">用户态/内核态切换   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md318"></a>
📦 第三方依赖</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">依赖   </th><th class="markdownTableHeadNone">用途    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/google/googletest.git">google/googletest</a>   </td><td class="markdownTableBodyNone">测试框架    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/charlesnicholson/nanoprintf.git">charlesnicholson/nanoprintf</a>   </td><td class="markdownTableBodyNone">printf 实现    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/MRNIU/cpu_io.git">MRNIU/cpu_io</a>   </td><td class="markdownTableBodyNone">CPU I/O 操作    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/riscv-software-src/opensbi.git">riscv-software-src/opensbi</a>   </td><td class="markdownTableBodyNone">RISC-V SBI 实现    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/MRNIU/opensbi_interface.git">MRNIU/opensbi_interface</a>   </td><td class="markdownTableBodyNone">OpenSBI 接口    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/u-boot/u-boot.git">u-boot/u-boot</a>   </td><td class="markdownTableBodyNone">通用引导程序    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/OP-TEE/optee_os.git">OP-TEE/optee_os</a>   </td><td class="markdownTableBodyNone">OP-TEE 操作系统    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/ARM-software/arm-trusted-firmware.git">ARM-software/arm-trusted-firmware</a>   </td><td class="markdownTableBodyNone">ARM 可信固件    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://git.kernel.org/pub/scm/utils/dtc/dtc.git">dtc/dtc</a>   </td><td class="markdownTableBodyNone">设备树编译器   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md319"></a>
📝 开发指南</h2>
<h3><a class="anchor" id="autotoc_md320"></a>
🎨 代码风格</h3>
<ul>
<li><b>语言标准</b>: C23 / C++23</li>
<li><b>编码规范</b>: <a href="https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/contents.html">Google C++ Style Guide</a></li>
<li><b>自动格式化</b>: <code>.clang-format</code> + <code>.clang-tidy</code></li>
<li><b>注释规范</b>: Doxygen 风格，接口文件必须包含完整的契约文档</li>
</ul>
<h3><a class="anchor" id="autotoc_md321"></a>
命名约定</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">类型   </th><th class="markdownTableHeadNone">风格   </th><th class="markdownTableHeadNone">示例    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">文件   </td><td class="markdownTableBodyNone">小写下划线   </td><td class="markdownTableBodyNone"><code><a class="el" href="kernel__log_8hpp.html">kernel_log.hpp</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">类/结构体   </td><td class="markdownTableBodyNone">PascalCase   </td><td class="markdownTableBodyNone"><code><a class="el" href="classTaskManager.html" title="任务管理器">TaskManager</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">函数   </td><td class="markdownTableBodyNone">PascalCase / snake_case   </td><td class="markdownTableBodyNone"><code>ArchInit</code> / <code>sys_yield</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">变量   </td><td class="markdownTableBodyNone">snake_case   </td><td class="markdownTableBodyNone"><code>per_cpu_data</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">宏   </td><td class="markdownTableBodyNone">SCREAMING_SNAKE   </td><td class="markdownTableBodyNone"><code>SIMPLEKERNEL_DEBUG</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">常量   </td><td class="markdownTableBodyNone">kCamelCase   </td><td class="markdownTableBodyNone"><code>kPageSize</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">内核 libc/libc++ 头文件   </td><td class="markdownTableBodyNone"><code>sk_</code> 前缀   </td><td class="markdownTableBodyNone"><code>sk_cstdio</code>   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md322"></a>
📋 Git Commit 规范</h3>
<div class="fragment"><div class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</div>
<div class="line"> </div>
<div class="line">type: feat|fix|docs|style|refactor|perf|test|build|revert</div>
<div class="line">scope: 可选，影响的模块 (arch, driver, libc)</div>
<div class="line">subject: 不超过50字符，不加句号</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md323"></a>
📚 文档</h3>
<ul>
<li><b>工具链</b>: <a class="el" href="md_0___xE5_xB7_xA5_xE5_x85_xB7_xE9_x93_xBE.html">doc/0_工具链.md</a></li>
<li><b>系统启动</b>: <a class="el" href="md_1___xE7_xB3_xBB_xE7_xBB_x9F_xE5_x90_xAF_xE5_x8A_xA8.html">doc/1_系统启动.md</a></li>
<li><b>调试输出</b>: <a class="el" href="md_2___xE8_xB0_x83_xE8_xAF_x95_xE8_xBE_x93_xE5_x87_xBA.html">doc/2_调试输出.md</a></li>
<li><b>中断</b>: <a class="el" href="md_3___xE4_xB8_xAD_xE6_x96_xAD.html">doc/3_中断.md</a></li>
<li><b>Docker</b>: <a class="el" href="md_docker.html">doc/docker.md</a></li>
<li><b>接口重构计划</b>: <a class="el" href="md_TODO__interface__refactor.html">doc/TODO_interface_refactor.md</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md324"></a>
🤝 贡献指南</h2>
<p>我们欢迎所有形式的贡献！</p>
<h3><a class="anchor" id="autotoc_md325"></a>
🎯 贡献方式</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">方式   </th><th class="markdownTableHeadNone">说明    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">🐛 <b>报告问题</b>   </td><td class="markdownTableBodyNone">通过 <a href="https://github.com/Simple-XX/SimpleKernel/issues">GitHub Issues</a> 报告 Bug    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">📐 <b>改进接口</b>   </td><td class="markdownTableBodyNone">提出更好的接口抽象和文档改进建议    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">🧪 <b>补充测试</b>   </td><td class="markdownTableBodyNone">为现有接口编写更完整的测试用例    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">📖 <b>完善文档</b>   </td><td class="markdownTableBodyNone">改进 Doxygen 注释、添加使用示例    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">🔧 <b>提交实现</b>   </td><td class="markdownTableBodyNone">提交接口的参考实现或替代实现   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md326"></a>
🔧 代码贡献流程</h3>
<ol type="1">
<li>Fork 本仓库</li>
<li>创建功能分支: <code>git checkout -b feat/amazing-feature</code></li>
<li>遵循代码规范进行开发</li>
<li>确保所有测试通过</li>
<li>提交变更: &lsquo;git commit -m 'feat(scope): add amazing feature&rsquo;`</li>
<li>创建 Pull Request</li>
</ol>
<h2><a class="anchor" id="autotoc_md327"></a>
📄 许可证</h2>
<p>本项目采用多重许可证：</p>
<ul>
<li><b>代码许可</b> - <a href="./LICENSE">MIT License</a></li>
<li><b>反 996 许可</b> - <a href="https://github.com/996icu/996.ICU/blob/master/LICENSE">Anti 996 License</a></li>
</ul>
<hr  />
<div align="center"></div><div align="center"><b>⭐ 如果这个项目对您有帮助，请给我们一个 Star！</b></div><div align="center"><b>🤖 让 AI 帮你写内核，让你专注于理解操作系统原理！</b></div><div align="center"><a href="https://github.com/Simple-XX/SimpleKernel">🌟 Star 项目</a> • <a href="https://github.com/Simple-XX/SimpleKernel/issues">🐛 报告问题</a> • <a href="https://github.com/Simple-XX/SimpleKernel/discussions">💬 参与讨论</a></div><div align="center"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
